{"version":3,"sources":["webpack://html5-chess/./frontend/src/Boards.ts","webpack://html5-chess/./frontend/src/ChessPieces/Advisor.ts","webpack://html5-chess/./frontend/src/ChessPieces/Bishop.ts","webpack://html5-chess/./frontend/src/ChessPieces/Cannon.ts","webpack://html5-chess/./frontend/src/ChessPieces/ChessPiece.ts","webpack://html5-chess/./frontend/src/ChessPieces/King.ts","webpack://html5-chess/./frontend/src/ChessPieces/Knight.ts","webpack://html5-chess/./frontend/src/ChessPieces/Pawn.ts","webpack://html5-chess/./frontend/src/ChessPieces/Rook.ts","webpack://html5-chess/./frontend/src/Game.ts","webpack://html5-chess/./frontend/src/frontend-utils.ts","webpack://html5-chess/./frontend/src/utils/FenNotation.ts","webpack://html5-chess/./src/Util.ts","webpack://html5-chess/webpack/bootstrap","webpack://html5-chess/webpack/startup"],"names":["Object","defineProperty","exports","value","Board","frontend_utils_1","FenNotation_1","game","this","ratio","side_length","SIDE_LENGTH","target_coordinate","intersections","Array","moves","half_move_counter","full_move_counter","i","j","Point","prototype","movePieceFromSrcToDest","piece","point_source","point_dest","setPiece","moveToPoint","getPointFromCoordinates","x_coor","y_coor","validateXCoordinate","validateYCoordinate","getCoordinateFromElemId","id","console","log","split_arr","split","coor_x","coor_y","parseInt","x","y","getRowFromYCoordinate","row","push","getColFromXCoordinate","col","getPiecePlacementString","ret_string","empty_points","_i","row_arr_1","length","point","piece_role","getActiveColor","active_piece","getColor","toString","increaseHalfMovementCount","increaseFullMoveCount","getFenString","FenNotation","getFenNotation","detectZoom","undefined","window","devicePixelRatio","outerWidth","innerWidth","Math","round","render","board","$","css","on","fitSize","document","extendStatics","__extends","d","b","setPrototypeOf","__proto__","p","hasOwnProperty","call","TypeError","String","__","constructor","create","__importDefault","mod","__esModule","BlackAdvisor","RedAdvisor","Util_1","ChessPiece_1","Advisor","_super","color","PieceRole","canMove","dest","abs","checkSameColorPieceInPoint","Piece","_this","PlayerColor","RED","elem","src","movablePoints","moveable_points","concat","checkPeriphery","X_coor","getX","Y_coor","getY","front_left","front_right","back_left","back_right","err","default","trace","error","movable_points_in_this_column","isValidGeneralPosition","getPiece","targetPoint","BLACK","RedWarElephant","BlackWarElephant","WarElephant","checkMoves","front_left_block_pos","front_right_block_pos","back_left_block_pos","back_right_block_pos","e","isValidPosition","BlackCannon","RedCannon","Cannon","isValidCannonPosition","checkRow","checkColumn","checkShellingRowLHS","checkShellingRowRHS","checkShellingColUpper","checkShellingColLower","piece_row","cornerstone_flag","shellable_points_in_this_column","index","cur_idx","piece_col","cornerstone_point","start_flag","end_flag","isFriendly","movable_points_in_this_row","enumerable","get","General","Chariot","Cavalry","Soldier","role","piece_role_dict","active","toUpperCase","toLowerCase","createElement","state","preventDefault","listenerManager","attachSelectPieceListener","getCurrentPlayer","movable_points","forEach","setTimeout","attachMoveToGridListener","target","tagName","parentNode","parentElement","target_point","includes","hasPiece","alert","removeMoveToGridListener","innerHTML","next_x_coor","next_y_coor","alternatePlayer","off","getElement","removeChild","appendChild","getRole","getTargetPointCoordinate","getTargetPointXCoordinate","getTargetPointYCoordinate","isEnemy","append","addClass","destroy","remove","adjustResize","screen","width","getChessBoardSize","getZoomedRatio","BlackKing","RedKing","King","front","back","left","right","RedKnight","BlackKnight","Knight","front_left_upper","front_left_upper_block","front_left_lower","front_left_lower_block","front_right_upper","front_right_upper_block","front_right_lower","front_right_lower_block","back_left_upper","back_left_upper_block","back_left_lower","back_left_lower_block","back_right_upper","back_right_upper_block","back_right_lower","back_right_lower_block","BlackPawn","RedPawn","Pawn","isValidPawnPosition","afterLanding","beforeLanding","movable_points_before_landing","movable_points_after_landing","BlackRook","RedRook","Rook","isValidChariotPosition","Boards_1","Rook_1","King_1","Cannon_1","Pawn_1","Advisor_1","Bishop_1","Knight_1","Game","chess_pieces","currentPlayer","full_move_counts","initializePieces","red_shuai","black_jiang","red_ju_one","red_ju_two","black_ju_one","black_ju_two","red_cannon_one","red_cannon_two","black_cannon_one","black_cannon_two","red_bing_one","red_bing_two","red_bing_three","red_bing_four","red_bing_five","black_zu_one","black_zu_two","black_zu_three","black_zu_four","black_zu_five","red_advisor_one","red_advisor_two","black_advisor_one","black_advisor_two","black_elephant_one","black_elephant_two","red_elephant_one","red_elephant_two","black_calvalry_one","black_calvalry_two","red_calvalry_one","red_calvalry_two","_a","destroyPieces","restart","getFullMoveCounts","SIDE_LENGTH_vw","chessboard","UcciXCoorMap","Map","UcciYCoorMap","ucci_x_coor","ucci_y_coor","updateElement","newCol","newRow","grid_div","oldCol","oldRow","className","when","then","piece_placement","active_color","castling_availability","en_passant_end_coordinate","__spreadArray","to","from","pack","arguments","ar","l","slice","Log","msg","apply","Date","toLocaleString","info","warn","test","__webpack_module_cache__","__webpack_require__","moduleId","module","__webpack_modules__"],"mappings":"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","file":"bundle.js","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Board = void 0;\r\nvar frontend_utils_1 = require(\"./frontend-utils\");\r\nvar FenNotation_1 = require(\"./utils/FenNotation\");\r\n// 棋盘\r\nvar Board = /** @class */ (function () {\r\n    function Board(game) {\r\n        // 游戏和棋盘要耦合\r\n        this.game = game;\r\n        // 缩放相关\r\n        this.ratio = 100; //default ratio 100%\r\n        this.side_length = this.ratio * 0.01 * frontend_utils_1.SIDE_LENGTH;\r\n        // 玩家选择的下一个位置\r\n        this.target_coordinate = [-1, -1];\r\n        //A.K.A points.\r\n        this.intersections = new Array();\r\n        this.moves = 0;\r\n        this.half_move_counter = 0;\r\n        this.full_move_counter = 1;\r\n        for (var i = 0; i < 9; i++) {\r\n            this.intersections[i] = [];\r\n            for (var j = 0; j < 10; j++) {\r\n                // UCCI坐标\r\n                //     a b c d e f g h i\r\n                // (9) 1 2 3 4 5 6 7 8 9\r\n                // (8) 2\r\n                // (7) 3\r\n                // (6) 4\r\n                // (5) 5\r\n                // (4) 6\r\n                // (3) 7\r\n                // (2) 8\r\n                // (1) 9\r\n                // (0) 10\r\n                this.intersections[i][j] = (new frontend_utils_1.Point((i + 1), (j + 1)));\r\n            }\r\n        }\r\n    }\r\n    //invokes functions in Piece and Point simutaniously\r\n    Board.prototype.movePieceFromSrcToDest = function (piece, point_source, point_dest) {\r\n        point_source.setPiece(null); //the piece is moving out to another grid, so it's set to null.\r\n        piece.moveToPoint(point_dest); // the piece now knows which new place it's in\r\n        point_dest.setPiece(piece); // the point the piece moves in knows which piece it's receiving.\r\n    };\r\n    //get a specific point from coordinates\r\n    Board.prototype.getPointFromCoordinates = function (x_coor, y_coor) {\r\n        if (!this.validateXCoordinate(x_coor) || !this.validateYCoordinate(y_coor))\r\n            return null;\r\n        return this.intersections[x_coor - 1][y_coor - 1];\r\n    };\r\n    // 从HTML Element的ID中获取坐标\r\n    Board.prototype.getCoordinateFromElemId = function (id) {\r\n        // grid_div_5_6\r\n        console.log(id);\r\n        var split_arr = id.split('_');\r\n        var coor_x = split_arr[2];\r\n        var coor_y = split_arr[3];\r\n        return [parseInt(coor_x), parseInt(coor_y)];\r\n    };\r\n    // Check for valid x coordinate\r\n    Board.prototype.validateXCoordinate = function (x) {\r\n        return x >= 1 && x <= 9;\r\n    };\r\n    // Check for valid y coordinate\r\n    Board.prototype.validateYCoordinate = function (y) {\r\n        return y >= 1 && y <= 10;\r\n    };\r\n    //get a row from y_coor(nth row)\r\n    Board.prototype.getRowFromYCoordinate = function (y_coor) {\r\n        var row = [];\r\n        for (var i = 0; i < 9; i++) {\r\n            row.push(this.intersections[i][y_coor - 1]);\r\n        }\r\n        return row;\r\n    };\r\n    //get a column from x_coor(nth col)\r\n    Board.prototype.getColFromXCoordinate = function (x_coor) {\r\n        var col = [];\r\n        for (var j = 0; j < 10; j++) {\r\n            col.push(this.intersections[x_coor - 1][j]);\r\n        }\r\n        return col;\r\n    };\r\n    // 获取局面字符串\r\n    Board.prototype.getPiecePlacementString = function () {\r\n        console.log(\"Getting Piece Placement:\");\r\n        var ret_string = \"\";\r\n        for (var row = 0; row <= 9; row++) { // 10行\r\n            var row_arr = this.getRowFromYCoordinate(row + 1);\r\n            var empty_points = 0;\r\n            for (var _i = 0, row_arr_1 = row_arr; _i < row_arr_1.length; _i++) {\r\n                var point = row_arr_1[_i];\r\n                // 坐标中有棋子\r\n                if (point.piece) {\r\n                    if (empty_points != 0) {\r\n                        ret_string += empty_points + '';\r\n                        empty_points = 0;\r\n                    }\r\n                    ret_string += point.piece.piece_role;\r\n                }\r\n                // \r\n                else {\r\n                    empty_points++;\r\n                }\r\n            }\r\n            if (row != 9) {\r\n                if (empty_points != 0) {\r\n                    ret_string += empty_points + '';\r\n                }\r\n                ret_string += '/';\r\n            }\r\n        }\r\n        // \r\n        console.log(ret_string);\r\n        return ret_string;\r\n    };\r\n    Board.prototype.getActiveColor = function () {\r\n        if (this.active_piece)\r\n            return this.active_piece.getColor().toString();\r\n        else\r\n            return \"\";\r\n    };\r\n    Board.prototype.increaseHalfMovementCount = function () {\r\n        this.half_move_counter++;\r\n    };\r\n    Board.prototype.increaseFullMoveCount = function () {\r\n        // TODO:   write a full move counter updater\r\n        this.full_move_counter++;\r\n    };\r\n    /**\r\n     *\r\n     * @returns the FEN notation, for the use of chess engines\r\n     */\r\n    Board.prototype.getFenString = function () {\r\n        return new FenNotation_1.FenNotation(this.getPiecePlacementString(), this.getActiveColor(), this.half_move_counter, this.full_move_counter)\r\n            .getFenNotation();\r\n    };\r\n    Board.prototype.detectZoom = function () {\r\n        var ratio = 0;\r\n        if (window.devicePixelRatio !== undefined) {\r\n            ratio = window.devicePixelRatio;\r\n        }\r\n        // ???? not working, why?\r\n        // else if (~ua.indexOf('msie')) {\r\n        //     if (screen.deviceXDPI && screen.logicalXDPI) {\r\n        //         ratio = screen.deviceXDPI / screen.logicalXDPI;\r\n        //     }\r\n        // }\r\n        else if (window.outerWidth !== undefined && window.innerWidth !== undefined) {\r\n            ratio = window.outerWidth / window.innerWidth;\r\n        }\r\n        if (ratio) {\r\n            ratio = Math.round(ratio * 100);\r\n        }\r\n        this.ratio = ratio;\r\n    };\r\n    Board.prototype.render = function () {\r\n        var board = $('#board');\r\n        // $(board).css('height', 'fit-content');\r\n        $(\"#id_chessboard\").css(\"position\", \"fixed\");\r\n        $(\"#id_chessboard\").css(\"max-height\", '100vh');\r\n        // $(\"#board\").css(\"left\", \"0px\");\r\n        $(\"#id_chessboard\").css(\"margin\", \"0\");\r\n        $(\"#id_chessboard\").css(\"padding\", \"0vw\");\r\n        board.css('margin-left', 'auto');\r\n        board.css('margin-right', 'auto');\r\n        board.css('padding', 0);\r\n        //for testing purposes, added some color to the background\r\n        $('.className_grid_div').css('background-color', 'rgba(255,0,0,0.3)');\r\n        //fits the size when resizing\r\n        $(window).on('resize', function () {\r\n            (0, frontend_utils_1.fitSize)();\r\n        });\r\n        //fixed the size issue upon entry\r\n        $(document).on('ready', function () {\r\n            (0, frontend_utils_1.fitSize)();\r\n        });\r\n        $(\"#board\").css(\"max-width\", \"100vh\");\r\n    };\r\n    return Board;\r\n}());\r\nexports.Board = Board;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BlackAdvisor = exports.RedAdvisor = void 0;\r\nvar Util_1 = __importDefault(require(\"../../../src/Util\"));\r\nvar ChessPiece_1 = require(\"./ChessPiece\");\r\nvar frontend_utils_1 = require(\"../frontend-utils\");\r\n// 士 \r\nvar Advisor = /** @class */ (function (_super) {\r\n    __extends(Advisor, _super);\r\n    function Advisor(point, board, color) {\r\n        return _super.call(this, point, board, ChessPiece_1.PieceRole.Advisor, color) || this;\r\n    }\r\n    Advisor.prototype.canMove = function (dest) {\r\n        var x = dest.x_coor;\r\n        var y = dest.y_coor;\r\n        //If the dest is not inside of the \"田\" shaped space of the board\r\n        //Returns false.\r\n        // if (!this.isValidGeneralPosition(x, y))\r\n        //     return false;\r\n        //If the place is outside of reach from the General,\r\n        //It returns false.\r\n        if (Math.abs(x - this.point.x_coor) > 1 || Math.abs(y - this.point.y_coor) > 1)\r\n            return false;\r\n        // We will add more logic for checking valid move later\r\n        // Current check is only for a valid position and no same side piece\r\n        return !_super.prototype.checkSameColorPieceInPoint.call(this, dest);\r\n    };\r\n    return Advisor;\r\n}(ChessPiece_1.Piece));\r\nvar RedAdvisor = /** @class */ (function (_super) {\r\n    __extends(RedAdvisor, _super);\r\n    function RedAdvisor(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.RED) || this;\r\n        // this.piece_role = this.piece_role.substring(0, 1).toUpperCase();\r\n        _this.elem.src = '../img/pieces/red-shi.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        return _this;\r\n    }\r\n    RedAdvisor.prototype.movablePoints = function () {\r\n        var moveable_points = [];\r\n        moveable_points = moveable_points.concat(this.checkPeriphery());\r\n        return moveable_points;\r\n    };\r\n    RedAdvisor.prototype.checkPeriphery = function () {\r\n        var X_coor = this.point.getX();\r\n        var Y_coor = this.point.getY();\r\n        var front_left = this.board.getPointFromCoordinates(X_coor - 1, Y_coor - 1);\r\n        var front_right = this.board.getPointFromCoordinates(X_coor + 1, Y_coor - 1); // HACK: tabnine generated those  '+' signs !\r\n        var back_left = new frontend_utils_1.Point(-1, -1); // WHY: 如果不建一个点，try catch里面的会是局部变量\r\n        var back_right = new frontend_utils_1.Point(-1, -1);\r\n        try {\r\n            back_left = this.board.getPointFromCoordinates(X_coor - 1, Y_coor + 1); //out of bound err\r\n            back_right = this.board.getPointFromCoordinates(X_coor + 1, Y_coor + 1);\r\n        }\r\n        catch (err) {\r\n            Util_1.default.trace(\"出错！\");\r\n            console.error(err);\r\n        }\r\n        var movable_points_in_this_column = [];\r\n        //  __ __   \r\n        // |__|__|\r\n        // |__|__|\r\n        // \r\n        console.log(\"++++++++++++++++++++++ debug +++++++++++++++++++++++\");\r\n        // 面前的格子\r\n        if (front_left && this.isValidGeneralPosition(front_left)) {\r\n            movable_points_in_this_column.push(front_left);\r\n        }\r\n        // \r\n        if (front_right && this.isValidGeneralPosition(front_right)) {\r\n            movable_points_in_this_column.push(front_right);\r\n        }\r\n        if (back_left && this.isValidGeneralPosition(back_left)) {\r\n            movable_points_in_this_column.push(back_left);\r\n        }\r\n        if (back_right && this.isValidGeneralPosition(back_right)) {\r\n            console.log(back_right.getPiece());\r\n            movable_points_in_this_column.push(back_right);\r\n        }\r\n        return movable_points_in_this_column;\r\n    };\r\n    RedAdvisor.prototype.isValidGeneralPosition = function (targetPoint) {\r\n        console.log('isValidGeneralPosition +++++++++++');\r\n        console.log(targetPoint);\r\n        console.log(targetPoint.getX());\r\n        console.log(targetPoint.getY());\r\n        // 外层if表示田字的横坐标范围\r\n        if (targetPoint.getX() >= 4 && targetPoint.getX() <= 6) {\r\n            // 内层是纵坐标范围\r\n            if (targetPoint.getY() >= 8 && targetPoint.getY() <= 10) {\r\n                return true;\r\n            }\r\n        }\r\n        // 以上条件不满足，则return false.\r\n        return false;\r\n    };\r\n    return RedAdvisor;\r\n}(Advisor));\r\nexports.RedAdvisor = RedAdvisor;\r\nvar BlackAdvisor = /** @class */ (function (_super) {\r\n    __extends(BlackAdvisor, _super);\r\n    function BlackAdvisor(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.BLACK) || this;\r\n        // this.piece_role = this.piece_role.substring(0, 1).toLowerCase();\r\n        _this.elem.src = '../img/pieces/black-shi.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        return _this;\r\n    }\r\n    BlackAdvisor.prototype.movablePoints = function () {\r\n        var moveable_points = [];\r\n        moveable_points = moveable_points.concat(this.checkPeriphery());\r\n        return moveable_points;\r\n    };\r\n    BlackAdvisor.prototype.checkPeriphery = function () {\r\n        var X_coor = this.point.getX();\r\n        var Y_coor = this.point.getY();\r\n        var front_left = this.board.getPointFromCoordinates(X_coor + 1, Y_coor + 1);\r\n        var front_right = this.board.getPointFromCoordinates(X_coor - 1, Y_coor + 1); // HACK: tabnine generated those  '+' signs !\r\n        var back_left = new frontend_utils_1.Point(-1, -1); // WHY: 如果不建一个点，try catch里面的会是局部变量\r\n        var back_right = new frontend_utils_1.Point(-1, -1);\r\n        try {\r\n            back_left = this.board.getPointFromCoordinates(X_coor + 1, Y_coor - 1); //out of bound err\r\n            back_right = this.board.getPointFromCoordinates(X_coor - 1, Y_coor - 1);\r\n        }\r\n        catch (err) {\r\n            Util_1.default.trace(\"出错！\");\r\n            console.error(err);\r\n        }\r\n        var movable_points_in_this_column = [];\r\n        //  __ __   \r\n        // |__|__|\r\n        // |__|__|\r\n        // \r\n        console.log(\"++++++++++++++++++++++ debug +++++++++++++++++++++++\");\r\n        // 面前的格子\r\n        if (front_left && this.isValidGeneralPosition(front_left)) {\r\n            movable_points_in_this_column.push(front_left);\r\n        }\r\n        // \r\n        if (front_right && this.isValidGeneralPosition(front_right)) {\r\n            movable_points_in_this_column.push(front_right);\r\n        }\r\n        if (back_left && this.isValidGeneralPosition(back_left)) {\r\n            movable_points_in_this_column.push(back_left);\r\n        }\r\n        if (back_right && this.isValidGeneralPosition(back_right)) {\r\n            console.log(back_right.getPiece());\r\n            movable_points_in_this_column.push(back_right);\r\n        }\r\n        return movable_points_in_this_column;\r\n    };\r\n    BlackAdvisor.prototype.isValidGeneralPosition = function (targetPoint) {\r\n        console.log('isValidGeneralPosition +++++++++++');\r\n        console.log(targetPoint);\r\n        console.log(targetPoint.getX());\r\n        console.log(targetPoint.getY());\r\n        // 外层if表示田字的横坐标范围\r\n        if (targetPoint.getX() >= 4 && targetPoint.getX() <= 6) {\r\n            // 内层是纵坐标范围\r\n            if (targetPoint.getY() >= 1 && targetPoint.getY() <= 3) {\r\n                return true;\r\n            }\r\n        }\r\n        // 以上条件不满足，则return false.\r\n        return false;\r\n    };\r\n    return BlackAdvisor;\r\n}(Advisor));\r\nexports.BlackAdvisor = BlackAdvisor;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RedWarElephant = exports.BlackWarElephant = void 0;\r\nvar Util_1 = __importDefault(require(\"../../../src/Util\"));\r\nvar ChessPiece_1 = require(\"./ChessPiece\");\r\nvar frontend_utils_1 = require(\"../frontend-utils\");\r\nvar WarElephant = /** @class */ (function (_super) {\r\n    __extends(WarElephant, _super);\r\n    function WarElephant(point, board, color) {\r\n        return _super.call(this, point, board, ChessPiece_1.PieceRole.WarElephant, color) || this;\r\n    }\r\n    WarElephant.prototype.canMove = function (dest) {\r\n        var x = dest.x_coor;\r\n        var y = dest.y_coor;\r\n        //If the place is outside of reach from the General,\r\n        //It returns false.\r\n        if (Math.abs(x - this.point.x_coor) > 1 || Math.abs(y - this.point.y_coor) > 1)\r\n            return false;\r\n        // We will add more logic for checking valid move later\r\n        // Current check is only for a valid position and no same side piece\r\n        return !_super.prototype.checkSameColorPieceInPoint.call(this, dest);\r\n    };\r\n    WarElephant.prototype.movablePoints = function () {\r\n        var moveable_points = [];\r\n        // \r\n        moveable_points = moveable_points.concat(this.checkMoves());\r\n        return moveable_points;\r\n    };\r\n    //returns the grids that the General can go in a row\r\n    WarElephant.prototype.checkMoves = function () {\r\n        Util_1.default.trace(\"in checkMoves()\");\r\n        // let Y_coor = this.point.y_coor\r\n        var X_coor = this.point.getX();\r\n        var Y_coor = this.point.getY();\r\n        var front_left = new frontend_utils_1.Point(-1, -1); // WHY: 如果不建一个点，try catch里面的会是局部变量\r\n        var front_left_block_pos = new frontend_utils_1.Point(-1, -1);\r\n        var front_right = new frontend_utils_1.Point(-1, -1);\r\n        var front_right_block_pos = new frontend_utils_1.Point(-1, -1);\r\n        var back_left = new frontend_utils_1.Point(-1, -1);\r\n        var back_left_block_pos = new frontend_utils_1.Point(-1, -1);\r\n        var back_right = new frontend_utils_1.Point(-1, -1);\r\n        var back_right_block_pos = new frontend_utils_1.Point(-1, -1);\r\n        front_left_block_pos = this.board.getPointFromCoordinates(X_coor + 1, Y_coor + 1);\r\n        front_right_block_pos = this.board.getPointFromCoordinates(X_coor - 1, Y_coor + 1);\r\n        back_left_block_pos = this.board.getPointFromCoordinates(X_coor + 1, Y_coor - 1);\r\n        back_right_block_pos = this.board.getPointFromCoordinates(X_coor - 1, Y_coor - 1);\r\n        // 没有堵象眼的阻碍才能走\r\n        try {\r\n            if (!front_left_block_pos.piece)\r\n                front_left = this.board.getPointFromCoordinates(X_coor + 2, Y_coor + 2);\r\n        }\r\n        catch (e) {\r\n        }\r\n        try {\r\n            if (!front_right_block_pos.piece)\r\n                front_right = this.board.getPointFromCoordinates(X_coor - 2, Y_coor + 2);\r\n        }\r\n        catch (e) {\r\n        }\r\n        try {\r\n            if (!back_left_block_pos.piece)\r\n                back_left = this.board.getPointFromCoordinates(X_coor + 2, Y_coor - 2);\r\n        }\r\n        catch (e) {\r\n        }\r\n        try {\r\n            if (!back_right_block_pos.piece)\r\n                back_right = this.board.getPointFromCoordinates(X_coor - 2, Y_coor - 2);\r\n        }\r\n        catch (e) {\r\n        }\r\n        var movable_points_in_this_column = [];\r\n        //  __ __   \r\n        // |__|__|\r\n        // |__|__|\r\n        // \r\n        console.log(\"++++++++++++++++++++++ debug +++++++++++++++++++++++\");\r\n        // 面前的格子\r\n        if (front_left && this.isValidPosition(front_left)) {\r\n            movable_points_in_this_column.push(front_left);\r\n        }\r\n        // \r\n        if (front_right && this.isValidPosition(front_right)) {\r\n            movable_points_in_this_column.push(front_right);\r\n        }\r\n        if (back_left && this.isValidPosition(back_left)) {\r\n            movable_points_in_this_column.push(back_left);\r\n        }\r\n        if (back_right && this.isValidPosition(back_right)) {\r\n            console.log(back_right.getPiece());\r\n            movable_points_in_this_column.push(back_right);\r\n        }\r\n        return movable_points_in_this_column;\r\n    };\r\n    return WarElephant;\r\n}(ChessPiece_1.Piece));\r\nvar BlackWarElephant = /** @class */ (function (_super) {\r\n    __extends(BlackWarElephant, _super);\r\n    function BlackWarElephant(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.BLACK) || this;\r\n        _this.elem.src = '../img/pieces/black-xiang.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        $(_this.elem).on('click', function () {\r\n            _super.prototype.movablePoints.call(_this);\r\n        });\r\n        return _this;\r\n    }\r\n    BlackWarElephant.prototype.isValidPosition = function (targetPoint) {\r\n        // 无法渡河\r\n        if (targetPoint.getY() <= 5) {\r\n            return true;\r\n        }\r\n        // 以上条件不满足，则return false.\r\n        return false;\r\n    };\r\n    return BlackWarElephant;\r\n}(WarElephant));\r\nexports.BlackWarElephant = BlackWarElephant;\r\nvar RedWarElephant = /** @class */ (function (_super) {\r\n    __extends(RedWarElephant, _super);\r\n    function RedWarElephant(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.RED) || this;\r\n        _this.elem.src = '../img/pieces/red-xiang.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        $(_this.elem).on('click', function () {\r\n            _super.prototype.movablePoints.call(_this);\r\n        });\r\n        return _this;\r\n    }\r\n    RedWarElephant.prototype.isValidPosition = function (targetPoint) {\r\n        // 无法渡河\r\n        if (targetPoint.getY() >= 6) {\r\n            return true;\r\n        }\r\n        // 以上条件不满足，则return false.\r\n        return false;\r\n    };\r\n    return RedWarElephant;\r\n}(WarElephant));\r\nexports.RedWarElephant = RedWarElephant;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BlackCannon = exports.RedCannon = void 0;\r\nvar Util_1 = __importDefault(require(\"../../../src/Util\"));\r\nvar ChessPiece_1 = require(\"./ChessPiece\");\r\nvar frontend_utils_1 = require(\"../frontend-utils\");\r\nvar Cannon = /** @class */ (function (_super) {\r\n    __extends(Cannon, _super);\r\n    function Cannon(point, board, color) {\r\n        return _super.call(this, point, board, ChessPiece_1.PieceRole.Cannon, color) || this;\r\n    }\r\n    /**\r\n     *\r\n     * @param x\r\n     * @param y\r\n     * @returns boolean to indicate if the pass in coordinate is valid general position\r\n     */\r\n    Cannon.prototype.isValidCannonPosition = function (x, y) {\r\n        return (y >= 0) && (y <= 10) && (x >= 0) && (x <= 9);\r\n    };\r\n    Cannon.prototype.canMove = function (dest) {\r\n        var x = dest.x_coor;\r\n        var y = dest.y_coor;\r\n        //If the dest is not inside of the \"田\" shaped space of the board\r\n        //Returns false.\r\n        if (!this.isValidCannonPosition(x, y))\r\n            return false;\r\n        //If the place is outside of reach from the General,\r\n        //It returns false.\r\n        if (Math.abs(x - this.point.x_coor) > 1 || Math.abs(y - this.point.y_coor) > 1)\r\n            return false;\r\n        // We will add more logic for checking valid move later\r\n        // Current check is only for a valid position and no same side piece\r\n        return !_super.prototype.checkSameColorPieceInPoint.call(this, dest);\r\n    };\r\n    Cannon.prototype.movablePoints = function () {\r\n        var moveable_points = [];\r\n        moveable_points = moveable_points.concat(this.checkRow());\r\n        moveable_points = moveable_points.concat(this.checkColumn());\r\n        moveable_points = moveable_points.concat(this.checkShellingRowLHS()); // HACK: reversed index trasversing\r\n        moveable_points = moveable_points.concat(this.checkShellingRowRHS());\r\n        moveable_points = moveable_points.concat(this.checkShellingColUpper()); // HACK: reversed index trasversing\r\n        moveable_points = moveable_points.concat(this.checkShellingColLower());\r\n        return moveable_points;\r\n    };\r\n    // 检查可以炮轰的地方\r\n    Cannon.prototype.checkShellingRowLHS = function () {\r\n        Util_1.default.trace(\"in checkShellingRowLHS()\");\r\n        Util_1.default.trace(\"Cannon\");\r\n        var X_coor = this.point.x_coor;\r\n        var piece_row = this.board.getRowFromYCoordinate(this.point.y_coor); //Checks the points in this row\r\n        var cornerstone_flag = false;\r\n        var shellable_points_in_this_column = [];\r\n        for (var index in piece_row) {\r\n            var cur_idx = (8 - parseInt(index)); // 0 ~ 8\r\n            console.log(cur_idx);\r\n            if (cur_idx + 1 < X_coor) {\r\n                Util_1.default.trace(\"正在检测该棋子的左侧\");\r\n                // 有任何一方的棋子\r\n                if (piece_row[cur_idx].piece) {\r\n                    // 有了炮台，下一个有棋子的格子就是可以走的\r\n                    if (cornerstone_flag) {\r\n                        shellable_points_in_this_column.push(piece_row[cur_idx]);\r\n                        break; //只加一个点进去就结束了\r\n                    }\r\n                    // 没有炮台，这就是炮台\r\n                    else if (!cornerstone_flag) {\r\n                        cornerstone_flag = true; // the index is not added, but the next one is.\r\n                        continue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return shellable_points_in_this_column;\r\n    };\r\n    // 检查可以炮轰的地方 RHS = right hand side \r\n    Cannon.prototype.checkShellingRowRHS = function () {\r\n        Util_1.default.trace(\"in checkShelling()\");\r\n        Util_1.default.trace(\"Cannon\");\r\n        // let Y_coor = this.point.y_coor\r\n        var X_coor = this.point.x_coor;\r\n        // let piece_col = this.board.getColFromXCoordinate(this.point.x_coor); //Checks the points in this column\r\n        var piece_row = this.board.getRowFromYCoordinate(this.point.y_coor); //Checks the points in this row\r\n        var cornerstone_flag = false;\r\n        var target_point_flag = -1;\r\n        var shellable_points_in_this_column = [];\r\n        for (var index in piece_row) {\r\n            if (parseInt(index) + 1 > X_coor) {\r\n                Util_1.default.trace(\"正在检测该棋子的右侧\");\r\n                // 有任何一方的棋子\r\n                if (piece_row[index].piece) {\r\n                    // 有了炮台，下一个有棋子的格子就是可以走的\r\n                    if (cornerstone_flag) {\r\n                        shellable_points_in_this_column.push(piece_row[index]);\r\n                        break; //只加一个点进去就结束了\r\n                    }\r\n                    // 没有炮台，这就是炮台\r\n                    else if (!cornerstone_flag) {\r\n                        cornerstone_flag = true; // the index is not added, but the next one is.\r\n                        continue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return shellable_points_in_this_column;\r\n    };\r\n    // 检查可以炮轰的地方\r\n    Cannon.prototype.checkShellingColUpper = function () {\r\n        Util_1.default.trace(\"in checkShellingColUpper()\");\r\n        Util_1.default.trace(\"Cannon\");\r\n        var Y_coor = this.point.y_coor;\r\n        var piece_col = this.board.getColFromXCoordinate(this.point.x_coor); //Checks the points in this column\r\n        var cornerstone_flag = false;\r\n        var cornerstone_point = new frontend_utils_1.Point(-1, -1);\r\n        var shellable_points_in_this_column = [];\r\n        for (var index in piece_col) {\r\n            var cur_idx = 9 - parseInt(index); // 0 ~ 9\r\n            if (cur_idx + 1 < Y_coor) {\r\n                Util_1.default.trace(\"正在检测该棋子的上方\");\r\n                // 有任何一方的棋子\r\n                if (piece_col[cur_idx].piece) {\r\n                    console.log('piece_col[index]piece_col[index] ===================++');\r\n                    console.log(piece_col[cur_idx]);\r\n                    // 有了炮台，下一个有棋子的格子就是可以走的\r\n                    if (cornerstone_flag) {\r\n                        Util_1.default.trace(\"有炮台了，添加以下点：\");\r\n                        Util_1.default.trace(piece_col[cur_idx]);\r\n                        shellable_points_in_this_column.push(piece_col[cur_idx]);\r\n                        break; //只加一个点进去就结束了\r\n                    }\r\n                    // 没有炮台，这就是炮台\r\n                    else if (!cornerstone_flag) {\r\n                        Util_1.default.trace(\"无炮台\");\r\n                        cornerstone_point = piece_col[cur_idx];\r\n                        console.log(\"炮台找到了！：\");\r\n                        console.log(cornerstone_point);\r\n                        cornerstone_flag = true; // the index is not added, but the next one is.\r\n                        continue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return shellable_points_in_this_column;\r\n    };\r\n    Cannon.prototype.checkShellingColLower = function () {\r\n        var Y_coor = this.point.y_coor;\r\n        // let X_coor = this.point.x_coor\r\n        var piece_col = this.board.getColFromXCoordinate(this.point.x_coor); //Checks the points in this column\r\n        // let piece_row = this.board.getRowFromYCoordinate(this.point.y_coor);//Checks the points in this row\r\n        var cornerstone_flag = false;\r\n        var cornerstone_point = new frontend_utils_1.Point(-1, -1);\r\n        var target_point_flag = -1;\r\n        var shellable_points_in_this_column = [];\r\n        for (var index in piece_col) {\r\n            // HACK 注意 coordinate 都是加过 1 的\r\n            if (parseInt(index) + 1 > Y_coor) {\r\n                Util_1.default.trace(\"正在检测该棋子的下方\");\r\n                // 检测到该点内有任何一方的棋子\r\n                if (piece_col[index].piece) {\r\n                    console.log('piece_col[index] ===================++');\r\n                    console.log(piece_col[index]);\r\n                    console.log(\"cornerstone_flag:\");\r\n                    console.log(cornerstone_flag);\r\n                    // 有了炮台，下一个有棋子的格子就是可以走的\r\n                    if (cornerstone_flag == true) {\r\n                        Util_1.default.trace(\"有炮台了，正在添加以下点：\");\r\n                        Util_1.default.trace(piece_col[index]);\r\n                        shellable_points_in_this_column.push(piece_col[index]);\r\n                        break; //只加一个点进去就结束了\r\n                    }\r\n                    // 没有炮台，这就是炮台\r\n                    else if (!cornerstone_flag) {\r\n                        cornerstone_flag = true; // the index is not added, but the next that has a piece is.\\\r\n                        Util_1.default.trace(\"之前无炮台，现在有炮台了:\");\r\n                        cornerstone_point = piece_col[index];\r\n                        console.log(cornerstone_flag);\r\n                        console.log(cornerstone_point);\r\n                        continue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return shellable_points_in_this_column;\r\n    };\r\n    //returns the grids that General can go in a column\r\n    Cannon.prototype.checkColumn = function () {\r\n        Util_1.default.trace(\"in checkColumn()\");\r\n        Util_1.default.trace(\"Cannon\");\r\n        var Y_coor = this.point.y_coor;\r\n        // let X_coor = this.point.x_coor\r\n        var piece_col = this.board.getColFromXCoordinate(this.point.x_coor); //Checks the points in this column\r\n        // let piece_row = this.board.getRowFromYCoordinate(this.point.y_coor);//Checks the points in this row\r\n        var start_flag = 0; //row 1\r\n        var end_flag = 9; //row 10 \r\n        //trasversing the column (Point [])\r\n        for (var index in piece_col) {\r\n            Util_1.default.trace('piece_col:');\r\n            Util_1.default.trace(piece_col);\r\n            //if the piece in that point is not null, do some checking\r\n            if (piece_col[index].piece != null) {\r\n                Util_1.default.trace(\"有棋子\");\r\n                //checks the indices that are smaller than the point\r\n                // 这颗待处理棋子在上方\r\n                if (parseInt(index) < Y_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_col[index].piece.color == ChessPiece_1.PlayerColor.BLACK) {\r\n                        Util_1.default.trace(\"队友在上方\");\r\n                        start_flag = parseInt(index) + 1; // the index is not added, but the next one is.\r\n                    }\r\n                    else if (piece_col[index].piece.color != ChessPiece_1.PlayerColor.BLACK) {\r\n                        start_flag = parseInt(index);\r\n                        console.log(\"debugging...........................\");\r\n                        console.log(start_flag);\r\n                    }\r\n                    if (start_flag === Y_coor - 1) // if a friendly piece is blocking right abovbe it\r\n                        start_flag = Y_coor; // start_flag is set to the next row \r\n                    // Log.trace(\"start_flag:\" + start_flag)\r\n                }\r\n                //checks those larger than that point\r\n                // 这颗待处理棋子在下方\r\n                else if (parseInt(index) > Y_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_col[index].piece.color == ChessPiece_1.PlayerColor.BLACK)\r\n                        end_flag = parseInt(index) - 1; // the index is not added, but the last one is.\r\n                    // 是敌方棋子的话：\r\n                    else if (piece_col[index].piece.color != ChessPiece_1.PlayerColor.BLACK)\r\n                        end_flag = parseInt(index);\r\n                    if (end_flag === Y_coor - 1) // if a friendly piece is blocking right below it\r\n                        end_flag = Y_coor - 2; // start_flag is set to the next row \r\n                    // Log.trace(\"end_flag:\" + end_flag)\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // an array to store all the movable points in a column\r\n        var movable_points_in_this_column = [];\r\n        for (var i = start_flag; i <= end_flag; i++) {\r\n            //If the coordinate is the one that piece is in\r\n            //It does not push it into the array.\r\n            if (Y_coor - 1 === i) {\r\n                // Log.trace('skip');\r\n                continue;\r\n            }\r\n            movable_points_in_this_column.push(piece_col[i]);\r\n        }\r\n        console.log(movable_points_in_this_column);\r\n        return movable_points_in_this_column;\r\n        // console.log(this.board.getColFromXCoordinate(X_coor));\r\n    };\r\n    //returns the grids that the General can go in a row\r\n    Cannon.prototype.checkRow = function () {\r\n        Util_1.default.trace(\"in checkRows()\");\r\n        // let Y_coor = this.point.y_coor\r\n        var X_coor = this.point.x_coor;\r\n        // let piece_col = this.board.getColFromXCoordinate(this.point.x_coor); //Checks the points in this column\r\n        var piece_row = this.board.getRowFromYCoordinate(this.point.y_coor); //Checks the points in this row\r\n        var start_flag = 0;\r\n        var end_flag = 8;\r\n        //trasversing the column (Point [])\r\n        //遍历横行\r\n        for (var index in piece_row) {\r\n            //if the piece in that point is not null, do some checking\r\n            //发现该点内有棋子，判断是敌是友\r\n            if (piece_row[index].piece != null) {\r\n                Util_1.default.trace(\"有棋子\");\r\n                Util_1.default.trace(piece_row);\r\n                //checks the indices that are smaller than the point\r\n                // 该枚车的左边\r\n                if (parseInt(index) < X_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_row[index].getPiece().isFriendly()) {\r\n                        console.log(\"---------------------------------debug-----------------------------\");\r\n                        start_flag = parseInt(index) + 1; // the index is not added, but the next one is.\r\n                    }\r\n                    else\r\n                        start_flag = parseInt(index);\r\n                    if (start_flag === X_coor - 1) // if a friendly piece is blocking immediately left to it\r\n                        start_flag = X_coor; // start_flag is set to the next row \r\n                    Util_1.default.trace(\"start_flag:\" + start_flag);\r\n                }\r\n                //checks those larger than that point\r\n                // 检查该车的右边\r\n                else if (parseInt(index) > X_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_row[index].getPiece().isFriendly())\r\n                        end_flag = parseInt(index) - 1; // Friendly blocking: the index is not added, but the previous one is.\r\n                    else\r\n                        end_flag = parseInt(index);\r\n                    if (end_flag === X_coor - 1) // if a friendly piece is blocking right below it\r\n                        end_flag = X_coor - 2; // start_flag is set to the next row \r\n                    Util_1.default.trace(\"end_flag:\" + end_flag);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // an array to store all the movable points in a column\r\n        var movable_points_in_this_row = [];\r\n        for (var i = start_flag; i <= end_flag; i++) {\r\n            //If the coordinate is the one that piece is in\r\n            //It does not push it into the array.\r\n            if (X_coor - 1 === i) {\r\n                continue;\r\n            }\r\n            movable_points_in_this_row.push(piece_row[i]);\r\n        }\r\n        console.log(movable_points_in_this_row);\r\n        return movable_points_in_this_row;\r\n    };\r\n    return Cannon;\r\n}(ChessPiece_1.Piece));\r\nvar BlackCannon = /** @class */ (function (_super) {\r\n    __extends(BlackCannon, _super);\r\n    function BlackCannon(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.BLACK) || this;\r\n        _this.elem.src = '../img/pieces/black-pao.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        $(_this.elem).on('click', function () {\r\n            _super.prototype.movablePoints.call(_this);\r\n        });\r\n        return _this;\r\n    }\r\n    return BlackCannon;\r\n}(Cannon));\r\nexports.BlackCannon = BlackCannon;\r\nvar RedCannon = /** @class */ (function (_super) {\r\n    __extends(RedCannon, _super);\r\n    function RedCannon(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.RED) || this;\r\n        _this.elem.src = '../img/pieces/red-pao.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        $(_this.elem).on('click', function () {\r\n            _super.prototype.movablePoints.call(_this);\r\n        });\r\n        return _this;\r\n    }\r\n    return RedCannon;\r\n}(Cannon));\r\nexports.RedCannon = RedCannon;\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PlayerColor = exports.PieceRole = exports.Piece = void 0;\r\nvar Util_1 = __importDefault(require(\"../../../src/Util\"));\r\nvar frontend_utils_1 = require(\"../frontend-utils\");\r\nObject.defineProperty(exports, \"PlayerColor\", { enumerable: true, get: function () { return frontend_utils_1.PlayerColor; } });\r\n// used in class Piece\r\n// 棋子颜色\r\n// enum PlayerColor {\r\n//     'BLACK',\r\n//     'RED'\r\n// }\r\n// used in class Game, \r\n// 玩家颜色\r\n// enum PlayerColor {\r\n//     'BLACK',\r\n//     'RED'\r\n// }\r\n// 棋子类型\r\nvar PieceRole = {\r\n    General: 'King',\r\n    Advisor: 'Advisor',\r\n    WarElephant: 'Bishop',\r\n    Chariot: 'Rook',\r\n    Cavalry: 'Night',\r\n    Cannon: 'Cannon',\r\n    Soldier: 'Pawn',\r\n};\r\nexports.PieceRole = PieceRole;\r\nvar Piece = /** @class */ (function () {\r\n    function Piece(point, board, role, color) {\r\n        this.piece_role_dict = {\r\n            General: 'King',\r\n            Advisor: 'Advisor',\r\n            WarElephant: 'Bishop',\r\n            Chariot: 'Rook',\r\n            Cavalry: 'Night',\r\n            Cannon: 'Cannon',\r\n            Soldier: 'Pawn',\r\n        };\r\n        // 与移动相关      \r\n        this.point = point; // 被置于某个点\r\n        // this.has_moved = false;                           // 是否已经被移动\r\n        this.active = false; // 是否被选中\r\n        // 与棋子属性相关\r\n        this.board = board; // 所在的棋盘\r\n        this.color = color; // 棋子颜色\r\n        // FEN Notation 当中，小写表示黑方，大写表示红方\r\n        if (this.color == frontend_utils_1.PlayerColor.RED) {\r\n            this.piece_role = role[0].toUpperCase();\r\n        }\r\n        else if (this.color == frontend_utils_1.PlayerColor.BLACK) {\r\n            this.piece_role = role[0].toLowerCase();\r\n        }\r\n        // 棋子的数据和显示是分开的 HTML Element\r\n        this.elem = document.createElement(\"img\");\r\n        // 与棋子大小有关\r\n        this.ratio = 100; // TODO:放大倍率 ?\r\n        this.side_length = this.ratio * 0.01 * frontend_utils_1.SIDE_LENGTH; // 棋子的边长\r\n        // 0 -> not selected\r\n        // 1 -> selected, not moved\r\n        // 2 -> moved, refesh state to 0\r\n        this.state = 0;\r\n        // this.fenNotation = new FenNotation()\r\n        $(window).on('mousedown', function (e) {\r\n            e.preventDefault(); //get rid of non-game experience (selecting pictures and stuff)\r\n        });\r\n        $(window).on('change', function (e) {\r\n            e.preventDefault(); //get rid of non-game experience (selecting pictures and stuff)\r\n            console.log('changed');\r\n        });\r\n        // 运行这个，就会把所有的Listener都加上\r\n        this.listenerManager();\r\n    }\r\n    Piece.prototype.listenerManager = function () {\r\n        this.attachSelectPieceListener();\r\n        // this.attachMoveToGridListener()\r\n        // this.removeMoveToGridListener()\r\n    };\r\n    /**\r\n     *  I. When the player clicks on a piece,\r\n     *  The listener invokes the method to determine movable grids,\r\n     *  then it highlights all the grids\r\n     */\r\n    Piece.prototype.attachSelectPieceListener = function () {\r\n        var _this = this;\r\n        // console.log(\"attachSelectPieceListener, check active:\")\r\n        console.log(this.board.active_piece);\r\n        // TODO：需要写一个逻辑，判断是否之前已经点过一个棋子\r\n        // 点击了棋子的img之后\r\n        $(this.elem).on('click', function (e) {\r\n            if (_this.board.active_piece &&\r\n                _this.board.active_piece != _this) {\r\n                console.log(\"之前选中了其他的棋子\");\r\n                if (_this.board.active_piece && _this.getCurrentPlayer() == _this.color) {\r\n                    _this.board.active_piece.active = false;\r\n                    _this.board.active_piece = undefined;\r\n                    return;\r\n                }\r\n            }\r\n            else {\r\n                console.log('新点击了棋子：');\r\n                console.log(_this.piece_role);\r\n                console.log(_this.elem);\r\n                e.preventDefault();\r\n                // 1. clearing all the colored background first:\r\n                $('.className_grid_div').css('background', 'rgba(3, 181, 252,0.0)');\r\n                // 2. put all the movalbe positions into an array\r\n                var movable_points = [];\r\n                movable_points = _this.movablePoints();\r\n                // console.log(movable_points)\r\n                // 3. highlight all the movalbe positions\r\n                // If the currentPlayer's color is the same as the piece color   \r\n                if (_this.getCurrentPlayer() == _this.color) {\r\n                    movable_points.forEach(function (point) {\r\n                        $(point.elem).css('background', 'rgba(3, 181, 252,0.5');\r\n                    });\r\n                }\r\n                // 设置自己被选中，告知棋盘选中的是自己\r\n                _this.active = true;\r\n                _this.board.active_piece = _this;\r\n                // TODO:找到ListenerManager的问题所在，并且把这个移动到那里面。\r\n                // 下一步是Move To Grid\r\n                setTimeout(function () {\r\n                    _this.attachMoveToGridListener();\r\n                }, 100);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     *  The user has selected a piece in step I.\r\n     *\r\n     *  II. once the user has selected the piece,\r\n     *  a listener is attached to the grid to check\r\n     *  which grid the user is moving to\r\n     *\r\n     *\r\n     *  在I中玩家已经选择了棋子\r\n     *\r\n     *  II.\r\n     *  在用attachSelectPieceListener()选择了棋子之后,\r\n     *  再用attachMoveToGridListener() 选择移动到哪个格子\r\n     */\r\n    Piece.prototype.attachMoveToGridListener = function () {\r\n        var _this = this;\r\n        console.log(this.point);\r\n        //1. attach another listener which listens to the next click:\r\n        $('.className_grid_div').on('click', function (e) {\r\n            console.log(\"点击了棋子:\");\r\n            console.log(e.target);\r\n            console.log(e.target.tagName);\r\n            console.log(\"\\u68CB\\u5B50\\u6240\\u5728\\u7684\\u683C\\u5B50:\");\r\n            console.log(e.target.parentNode);\r\n            console.log(e.target.parentElement);\r\n            // ① if the piece is selected, then go on and see if the grid is moveable\r\n            // ① 如果已经选择了某个棋子，判断是否能够走\r\n            if (_this.board.active_piece && // Condition #1 : 选中了棋子\r\n                _this.board.game.getCurrentPlayer() == _this.color) { // Condition #2 : 是当前玩家走\r\n                console.log('the piece is selected?' + _this.active);\r\n                console.log(\"active piece:\");\r\n                console.log(_this.board.active_piece);\r\n                console.log(_this.board.target_coordinate);\r\n                // 如果点击的是棋子，而不是空的格子\r\n                // 判断条件：HTML元素是IMG而不是DIV\r\n                if ((e.target.tagName).toUpperCase() == 'IMG') {\r\n                    console.log(\"点击了另一个棋子\");\r\n                    var parentNode = e.target.parentElement;\r\n                    if (parentNode != null) {\r\n                        console.log(\"棋子所在的格子：\");\r\n                        console.log(parentNode);\r\n                        // 记录下一步要走的坐标\r\n                        _this.board.target_coordinate = _this.board.getCoordinateFromElemId(parentNode.id);\r\n                    }\r\n                }\r\n                else {\r\n                    console.log(\"点击了一个空的格子\");\r\n                    _this.board.target_coordinate = _this.board.getCoordinateFromElemId(e.target.id);\r\n                }\r\n                console.log(_this.board.getPointFromCoordinates(_this.board.target_coordinate[0], _this.board.target_coordinate[1]));\r\n                var target_point = _this.board.getPointFromCoordinates(_this.board.target_coordinate[0], _this.board.target_coordinate[1]);\r\n                // 可以走的点不存在于这个Array上\r\n                if (!_this.movablePoints().includes(target_point)) {\r\n                    console.log(\"不能这么走！！！\");\r\n                    return;\r\n                }\r\n                // ①.a 如果不是 [-1, -1], 说明玩家选择了某个格子\r\n                if (_this.board.target_coordinate[0] != -1 && _this.board.target_coordinate[1] != -1) {\r\n                    // 增加一个判断条件，看这个位置是否有棋子\r\n                    // TODO: check if the point's 'piece' key is available at all?\r\n                    if (_this.board.getPointFromCoordinates(_this.board.target_coordinate[0], _this.board.target_coordinate[1]).hasPiece()) {\r\n                        // console.log(\"=========================== debug =================================\")\r\n                        // console.log(\"该点有棋子\")\r\n                        // console.log(this.isFriendly(this.board.getPointFromCoordinates(this.board.target_coordinate[0], this.board.target_coordinate[1]).getPiece()))\r\n                        // 棋子是自己人的\r\n                        // 那么选中的棋子则换为该棋子\r\n                        if (_this.isFriendly(_this.board.getPointFromCoordinates(_this.board.target_coordinate[0], _this.board.target_coordinate[1]).getPiece())) {\r\n                            alert(\"You Can't Move Here, A Friendly Piece is at this Position\");\r\n                            _this.removeMoveToGridListener();\r\n                            return; //直接结束\r\n                        }\r\n                        // 不是自己人的，要提子\r\n                        // TODO:增加提子逻辑\r\n                        else if (!_this.isFriendly(_this.board.getPointFromCoordinates(_this.board.target_coordinate[0], _this.board.target_coordinate[1]).getPiece())) {\r\n                            // alert(\"正在提子\")\r\n                            // 目标Point中移除piece\r\n                            delete _this.board.getPointFromCoordinates(_this.board.target_coordinate[0], _this.board.target_coordinate[1]).piece;\r\n                            console.log(\"=========  debug ===========\");\r\n                            console.log(_this.board.getPointFromCoordinates(_this.board.target_coordinate[0], _this.board.target_coordinate[1]));\r\n                            // 目标Point.elem 移除 HTML元素\r\n                            _this.board.getPointFromCoordinates(_this.board.target_coordinate[0], _this.board.target_coordinate[1]).elem.innerHTML = '';\r\n                        }\r\n                        else {\r\n                            // 目标Point中移除piece\r\n                            delete _this.board.getPointFromCoordinates(_this.board.target_coordinate[0], _this.board.target_coordinate[1]).piece;\r\n                            // console.log(\"=========  debug ===========\")\r\n                            // console.log(this.board.getPointFromCoordinates(this.board.target_coordinate[0], this.board.target_coordinate[1]))\r\n                            // 目标Point.elem 移除 HTML元素\r\n                            _this.board.getPointFromCoordinates(_this.board.target_coordinate[0], _this.board.target_coordinate[1]).elem.innerHTML = '';\r\n                        }\r\n                    }\r\n                    // \r\n                    else {\r\n                        _this.board.getPointFromCoordinates(_this.board.target_coordinate[0], _this.board.target_coordinate[1]).elem.innerHTML = '';\r\n                    }\r\n                    console.log(_this.board.target_coordinate);\r\n                    var next_x_coor = _this.board.target_coordinate[0];\r\n                    var next_y_coor = _this.board.target_coordinate[1];\r\n                    // 棋子属性、Element移动到目标点, 详见moveToPoint\r\n                    _this.board.active_piece.moveToPoint(_this.board.getPointFromCoordinates(next_x_coor, next_y_coor));\r\n                    $('.className_grid_div').css('background', 'rgba(0,0,0,0.0)'); // setting back the background to non-colored and transparent\r\n                    _this.board.target_coordinate = [-1, -1]; // 重新归[-1, -1]\r\n                    _this.active = false; // 棋子状态为不再选中\r\n                    // TODO >>>>>  Remove if not needed anymore <<<<<<<<<\r\n                    // console.log('the piece is selected?' + this.active);\r\n                    // console.log(`active piece:`);\r\n                    // console.log(this.board.active_piece);\r\n                    // console.log(this.board.target_coordinate )\r\n                    _this.board.game.alternatePlayer(); // 切换到下一个玩家\r\n                }\r\n            }\r\n            // ② 还没有选中棋子\r\n            else {\r\n                console.log(\"还没有选择棋子......\");\r\n                console.log('Is the piece is selected? ' + _this.active);\r\n                console.log('Doing nothing...');\r\n                $('.className_grid_div').css('background', 'rgba(0,0,0,0.0)'); // setting back the background to non-colored and transparent\r\n            }\r\n            _this.removeMoveToGridListener();\r\n            // $('.className_grid_div').unbind('click');  // HACK after clicking, we need to get rid of the listener\r\n            // $('.className_grid_div').css('background', 'rgba(0,0,0,0.0)') // setting back the background to non-colored and transparent\r\n        });\r\n    };\r\n    //upon finishing the listener, it removes the listener from the grid\r\n    Piece.prototype.removeMoveToGridListener = function () {\r\n        this.board.active_piece = null;\r\n        //4. remove the click listener from the grids\r\n        console.log('已经点击了移动目标格,现在移除MoveToGridListener');\r\n        $('.className_grid_div').off('click'); // after clicking, we need to get rid of the listener\r\n        $('.className_grid_div').css('background', 'rgba(0,0,0,0.0)'); // setting back the background to non-colored and transparent\r\n    };\r\n    // 可以走的点\r\n    Piece.prototype.movablePoints = function () {\r\n        Util_1.default.trace('movable points of a piece');\r\n        return [];\r\n    };\r\n    Piece.prototype.getElement = function () {\r\n        return this.elem;\r\n    };\r\n    //sets the point of the piece\r\n    Piece.prototype.moveToPoint = function (point) {\r\n        // 删除原来的html元素\r\n        this.board.intersections[this.point.x_coor - 1][this.point.y_coor - 1].elem.removeChild(this.elem);\r\n        delete this.board.intersections[this.point.x_coor - 1][this.point.y_coor - 1].piece;\r\n        // 更换到新的点\r\n        this.point = point;\r\n        this.board.intersections[this.point.x_coor - 1][this.point.y_coor - 1].elem.appendChild(this.elem);\r\n        this.board.intersections[this.point.x_coor - 1][this.point.y_coor - 1].piece = this;\r\n        this.board.getFenString();\r\n        this.board.increaseFullMoveCount();\r\n        console.log(\"当前的FEN string:\", this.board.getFenString());\r\n    };\r\n    // ========= Getter & Setters =========================================\r\n    /**\r\n     * 获取棋子的类型\r\n     * Get Piece Role\r\n     */\r\n    Piece.prototype.getRole = function () {\r\n        return this.piece_role;\r\n    };\r\n    /**\r\n     * 获取棋子的颜色\r\n     * Get Piece Color\r\n     */\r\n    Piece.prototype.getColor = function () {\r\n        return this.color;\r\n    };\r\n    Piece.prototype.getCurrentPlayer = function () {\r\n        return this.board.game.getCurrentPlayer();\r\n    };\r\n    // \r\n    // ------------------ 下一目标点 ------------------------\r\n    // 目标点的坐标\r\n    Piece.prototype.getTargetPointCoordinate = function () {\r\n        return this.board.target_coordinate;\r\n    };\r\n    // 获得目标点的 X 坐标\r\n    Piece.prototype.getTargetPointXCoordinate = function () {\r\n        return this.board.target_coordinate[0];\r\n    };\r\n    // 获得目标点的 Y 坐标\r\n    Piece.prototype.getTargetPointYCoordinate = function () {\r\n        return this.board.target_coordinate[1];\r\n    };\r\n    /**\r\n     * @param point Check if a point has a piece with the same side\r\n     *\r\n     */\r\n    Piece.prototype.checkSameColorPieceInPoint = function (point) {\r\n        var piece = point.getPiece();\r\n        if (!piece) {\r\n            return false;\r\n        }\r\n        return piece.getColor() === this.color;\r\n    };\r\n    /**\r\n    * @param point Check if a point has a piece with the same side\r\n    *              判断传入的参数中的该枚棋子是否是友军\r\n    */\r\n    Piece.prototype.isFriendly = function (piece) {\r\n        // console.log(piece)\r\n        try {\r\n            if (!piece) {\r\n                console.log(\"没有棋子！\");\r\n            }\r\n            // FIXME：PROBLEM\r\n            return piece.getColor() === this.color;\r\n        }\r\n        catch (e) {\r\n            console.log(\"没有棋子！\");\r\n        }\r\n        return true;\r\n    };\r\n    Piece.prototype.isEnemy = function (piece) {\r\n        if (!piece) {\r\n            return false;\r\n        }\r\n        return piece.getColor() != this.color;\r\n    };\r\n    // 渲染HTML Elements.\r\n    // Render the html elements to the webpage.\r\n    Piece.prototype.render = function () {\r\n        this.board.intersections[this.point.x_coor - 1][this.point.y_coor - 1].elem.append(this.elem); // encapsulates the next line of code;\r\n        $(this.elem).addClass('pieces');\r\n        //add className for the HTML <img> of the piece - PieceRole\r\n        $(this.elem).addClass(this.piece_role.toString());\r\n        //add className for the HTML <img> of the piece - PieceColor\r\n        $(this.elem).addClass(frontend_utils_1.PlayerColor[this.color].toString());\r\n        // $(window).on('resize',Piece.adjustResize);\r\n        // $(this.elem)\r\n        //     .on('mousedown',function () {\r\n        //         isDragging = false;\r\n        //         console.log(isDragging)\r\n        //     })\r\n        //     .on('mousemove',function () {\r\n        //         isDragging = true;\r\n        //         console.log(isDragging)\r\n        //     })\r\n        //     .on('mouseup',function () {\r\n        //         var wasDragging = isDragging;\r\n        //         isDragging = false;\r\n        //         console.log(isDragging)\r\n        //         if (!wasDragging) {\r\n        //             console.log('dragging')\r\n        //             $(\"#throbble\").toggle();\r\n        //         }\r\n        //     });\r\n        // TODO: click events:\r\n    };\r\n    Piece.prototype.destroy = function () {\r\n        this.board.intersections[this.point.x_coor - 1][this.point.y_coor - 1].elem.remove(this.elem); // encapsulates the next line of code;\r\n    };\r\n    // 调整棋盘、棋子的大小\r\n    Piece.adjustResize = function () {\r\n        if (screen.width == window.innerWidth) {\r\n            console.log(\"at exact 100%\");\r\n            (0, frontend_utils_1.getChessBoardSize)(); // 判断棋盘的大小\r\n            $('.className_grid_div').css('width', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100)); // 更新棋盘的宽度\r\n            $('.className_grid_div').css('height', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100)); // 更新棋盘的高度\r\n            $('.pieces').css('width', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100)); // 更新棋子的高度\r\n            $('.pieces').css('height', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100)); // 更新棋子的宽度\r\n            $(\"#board\").css(\"width\", $(\"#board\").css('height'));\r\n            $(\"#id_chessboard\").css(\"width\", $(\"#board\").css('width')); // 棋盘的宽度和高度统一 \r\n        }\r\n        else if (screen.width > window.innerWidth) {\r\n            console.log(\"you have zoomed in the page i.e more than 100%\");\r\n            (0, frontend_utils_1.getZoomedRatio)();\r\n            (0, frontend_utils_1.getChessBoardSize)();\r\n            $('.className_grid_div').css('width', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100));\r\n            $('.className_grid_div').css('height', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100));\r\n            $('.pieces').css('width', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100));\r\n            $('.pieces').css('height', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100));\r\n            $(\"#board\").css(\"width\", $(\"#board\").css('height'));\r\n            $('#board').css('column-gap', '0px');\r\n            $(\"#id_chessboard\").css(\"width\", $(\"#board\").css('width'));\r\n        }\r\n        else {\r\n            console.log(\"you have zoomed out i.e less than 100%\");\r\n            (0, frontend_utils_1.getZoomedRatio)();\r\n            (0, frontend_utils_1.getChessBoardSize)();\r\n            var current_width = $('.className_grid_div').css('width');\r\n            $('.className_grid_div').css('width', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100));\r\n            $('.className_grid_div').css('height', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100));\r\n            $('.pieces').css('width', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100));\r\n            $('.pieces').css('height', frontend_utils_1.SIDE_LENGTH * ((0, frontend_utils_1.getZoomedRatio)() / 100));\r\n            $(\"#board\").css(\"width\", $(\"#board\").css('height'));\r\n            $(\"#id_chessboard\").css(\"width\", $(\"#board\").css('width'));\r\n        }\r\n    };\r\n    return Piece;\r\n}());\r\nexports.Piece = Piece;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BlackKing = exports.RedKing = void 0;\r\nvar ChessPiece_1 = require(\"./ChessPiece\");\r\nvar frontend_utils_1 = require(\"../frontend-utils\");\r\nvar King = /** @class */ (function (_super) {\r\n    __extends(King, _super);\r\n    function King(point, board, color) {\r\n        return _super.call(this, point, board, ChessPiece_1.PieceRole.General, color) || this;\r\n    }\r\n    King.prototype.canMove = function (dest) {\r\n        var x = dest.x_coor;\r\n        var y = dest.y_coor;\r\n        //If the dest is not inside of the \"田\" shaped space of the board\r\n        //Returns false.\r\n        // if (!this.isValidGeneralPosition(x, y))\r\n        //     return false;\r\n        //If the place is outside of reach from the General,\r\n        //It returns false.\r\n        if (Math.abs(x - this.point.x_coor) > 1 || Math.abs(y - this.point.y_coor) > 1)\r\n            return false;\r\n        // We will add more logic for checking valid move later\r\n        // Current check is only for a valid position and no same side piece\r\n        return !_super.prototype.checkSameColorPieceInPoint.call(this, dest);\r\n    };\r\n    return King;\r\n}(ChessPiece_1.Piece));\r\nvar RedKing = /** @class */ (function (_super) {\r\n    __extends(RedKing, _super);\r\n    function RedKing(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.RED) || this;\r\n        _this.elem.src = '../img/pieces/red-shuai.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        return _this;\r\n    }\r\n    RedKing.prototype.movablePoints = function () {\r\n        var moveable_points = [];\r\n        moveable_points = moveable_points.concat(this.checkPeriphery());\r\n        return moveable_points;\r\n    };\r\n    //returns the grids that General can go in a column\r\n    RedKing.prototype.checkPeriphery = function () {\r\n        var Y_coor = this.point.y_coor;\r\n        var X_coor = this.point.x_coor;\r\n        var front = this.board.getPointFromCoordinates(X_coor, Y_coor - 1);\r\n        var back = this.board.getPointFromCoordinates(X_coor, Y_coor + 1); //out of bound err\r\n        var left = this.board.getPointFromCoordinates(X_coor - 1, Y_coor);\r\n        var right = this.board.getPointFromCoordinates(X_coor + 1, Y_coor);\r\n        var movable_points_in_this_column = [];\r\n        //  __ __   \r\n        // |__|__|\r\n        // |__|__|\r\n        // \r\n        console.log(\"+++++++++++++ debug +++++++++++++++++++++++\");\r\n        // 面前的格子\r\n        if (front && this.isValidGeneralPosition(front)) {\r\n            console.log('front.getPiece()');\r\n            console.log(front.getPiece());\r\n            movable_points_in_this_column.push(front);\r\n        }\r\n        if (back && this.isValidGeneralPosition(back)) {\r\n            console.log('back.getPiece()');\r\n            console.log(back.getPiece());\r\n            movable_points_in_this_column.push(back);\r\n        }\r\n        if (left && this.isValidGeneralPosition(left)) {\r\n            console.log('back.getPiece()');\r\n            console.log(left.getPiece());\r\n            movable_points_in_this_column.push(left);\r\n        }\r\n        if (right && this.isValidGeneralPosition(right)) {\r\n            console.log('back.getPiece()');\r\n            console.log(right.getPiece());\r\n            movable_points_in_this_column.push(right);\r\n        }\r\n        return movable_points_in_this_column;\r\n    };\r\n    RedKing.prototype.isValidGeneralPosition = function (targetPoint) {\r\n        console.log('isValidGeneralPosition +++++++++++');\r\n        console.log(targetPoint);\r\n        console.log(targetPoint.getX());\r\n        console.log(targetPoint.getY());\r\n        // 外层if表示田字的横坐标范围\r\n        if (targetPoint.getX() - 1 >= 3 && targetPoint.getX() - 1 <= 5) {\r\n            // 内层是纵坐标范围\r\n            if (targetPoint.getY() - 1 >= 7 && targetPoint.getY() - 1 <= 9) {\r\n                return true;\r\n            }\r\n        }\r\n        // 以上条件不满足，则return false.\r\n        return false;\r\n    };\r\n    return RedKing;\r\n}(King));\r\nexports.RedKing = RedKing;\r\nvar BlackKing = /** @class */ (function (_super) {\r\n    __extends(BlackKing, _super);\r\n    function BlackKing(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.BLACK) || this;\r\n        _this.elem.src = '../img/pieces/black-jiang.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        return _this;\r\n    }\r\n    BlackKing.prototype.movablePoints = function () {\r\n        var moveable_points = [];\r\n        moveable_points = moveable_points.concat(this.checkPeriphery());\r\n        return moveable_points;\r\n    };\r\n    BlackKing.prototype.checkPeriphery = function () {\r\n        var X_coor = this.point.getX();\r\n        var Y_coor = this.point.getY();\r\n        var front = this.board.getPointFromCoordinates(X_coor, Y_coor - 1);\r\n        var back = new frontend_utils_1.Point(-1, -1);\r\n        try {\r\n            back = this.board.getPointFromCoordinates(X_coor, Y_coor + 1); //out of bound err\r\n        }\r\n        catch (err) {\r\n            console.error(err);\r\n        }\r\n        var left = this.board.getPointFromCoordinates(X_coor - 1, Y_coor);\r\n        var right = this.board.getPointFromCoordinates(X_coor + 1, Y_coor);\r\n        var movable_points_in_this_column = [];\r\n        //  __ __   \r\n        // |__|__|\r\n        // |__|__|\r\n        // \r\n        console.log(\"++++++++++++++++++++++ debug +++++++++++++++++++++++\");\r\n        // 面前的格子\r\n        if (front && this.isValidGeneralPosition(front)) {\r\n            console.log('front.getPiece()');\r\n            console.log(front.getPiece());\r\n            movable_points_in_this_column.push(front);\r\n        }\r\n        if (back && this.isValidGeneralPosition(back)) {\r\n            console.log('back.getPiece()');\r\n            console.log(back.getPiece());\r\n            movable_points_in_this_column.push(back);\r\n        }\r\n        if (left && this.isValidGeneralPosition(left)) {\r\n            console.log('back.getPiece()');\r\n            console.log(left.getPiece());\r\n            movable_points_in_this_column.push(left);\r\n        }\r\n        if (right && this.isValidGeneralPosition(right)) {\r\n            console.log('back.getPiece()');\r\n            console.log(right.getPiece());\r\n            movable_points_in_this_column.push(right);\r\n        }\r\n        return movable_points_in_this_column;\r\n    };\r\n    BlackKing.prototype.isValidGeneralPosition = function (targetPoint) {\r\n        console.log('isValidGeneralPosition +++++++++++');\r\n        console.log(targetPoint);\r\n        console.log(targetPoint.getX());\r\n        console.log(targetPoint.getY());\r\n        // 外层if表示田字的横坐标范围\r\n        if (targetPoint.getX() >= 4 && targetPoint.getX() - 1 <= 6) {\r\n            // 内层是纵坐标范围\r\n            if (targetPoint.getY() >= 1 && targetPoint.getY() <= 3) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    return BlackKing;\r\n}(King));\r\nexports.BlackKing = BlackKing;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RedKnight = exports.BlackKnight = void 0;\r\nvar Util_1 = __importDefault(require(\"../../../src/Util\"));\r\nvar ChessPiece_1 = require(\"./ChessPiece\");\r\nvar frontend_utils_1 = require(\"../frontend-utils\");\r\nvar Knight = /** @class */ (function (_super) {\r\n    __extends(Knight, _super);\r\n    function Knight(point, board, color) {\r\n        return _super.call(this, point, board, ChessPiece_1.PieceRole.Cavalry, color) || this;\r\n    }\r\n    /**\r\n     *\r\n     * @param x\r\n     * @param y\r\n     * @returns boolean to indicate if the pass in coordinate is valid general position\r\n     */\r\n    Knight.prototype.isValidPosition = function (targetPoint) {\r\n        // 不得离开地图\r\n        if (targetPoint.getY() >= 1 && targetPoint.getY() <= 10) {\r\n            if (targetPoint.getX() >= 1 && targetPoint.getX() <= 9)\r\n                return true;\r\n        }\r\n        // 以上条件不满足，则return false.\r\n        return false;\r\n    };\r\n    Knight.prototype.canMove = function (dest) {\r\n        var x = dest.x_coor;\r\n        var y = dest.y_coor;\r\n        //If the place is outside of reach from the General,\r\n        //It returns false.\r\n        if (Math.abs(x - this.point.x_coor) > 1 || Math.abs(y - this.point.y_coor) > 1)\r\n            return false;\r\n        // We will add more logic for checking valid move later\r\n        // Current check is only for a valid position and no same side piece\r\n        return !_super.prototype.checkSameColorPieceInPoint.call(this, dest);\r\n    };\r\n    // 可以走的点位\r\n    Knight.prototype.movablePoints = function () {\r\n        var moveable_points = [];\r\n        moveable_points = moveable_points.concat(this.checkMoves());\r\n        console.log(\"movable points:\");\r\n        console.log(moveable_points);\r\n        return moveable_points;\r\n    };\r\n    //returns the grids that the General can go in a row\r\n    Knight.prototype.checkMoves = function () {\r\n        Util_1.default.trace(\"in checkMoves()\");\r\n        // let Y_coor = this.point.y_coor\r\n        var X_coor = this.point.getX();\r\n        var Y_coor = this.point.getY();\r\n        // 左前-11点钟\r\n        var front_left_upper = new frontend_utils_1.Point(-1, -1); // WHY: 如果不建一个点，try catch里面的会是局部变量\r\n        var front_left_upper_block = this.board.getPointFromCoordinates(X_coor, Y_coor - 1);\r\n        // 左前-10点钟\r\n        var front_left_lower = new frontend_utils_1.Point(-1, -1);\r\n        var front_left_lower_block = this.board.getPointFromCoordinates(X_coor - 1, Y_coor);\r\n        // 右前-1点钟\r\n        var front_right_upper = new frontend_utils_1.Point(-1, -1);\r\n        var front_right_upper_block = this.board.getPointFromCoordinates(X_coor, Y_coor - 1);\r\n        // 右前-2点钟\r\n        var front_right_lower = new frontend_utils_1.Point(-1, -1);\r\n        var front_right_lower_block = this.board.getPointFromCoordinates(X_coor + 1, Y_coor);\r\n        // 左后-8点 \r\n        var back_left_upper = new frontend_utils_1.Point(-1, -1); // WHY: 如果不建一个点，try catch里面的会是局部变量\r\n        var back_left_upper_block = this.board.getPointFromCoordinates(X_coor - 1, Y_coor);\r\n        // 左后-7点\r\n        var back_left_lower = new frontend_utils_1.Point(-1, -1);\r\n        var back_left_lower_block = this.board.getPointFromCoordinates(X_coor, Y_coor + 1);\r\n        // 右后-上\r\n        var back_right_upper = new frontend_utils_1.Point(-1, -1);\r\n        var back_right_upper_block = this.board.getPointFromCoordinates(X_coor + 1, Y_coor);\r\n        // 右后-下\r\n        var back_right_lower = new frontend_utils_1.Point(-1, -1);\r\n        var back_right_lower_block = this.board.getPointFromCoordinates(X_coor, Y_coor + 1);\r\n        // 没有挡马眼的阻碍才能走\r\n        // In the following graphs, 'S' means Starting Point, 'B' means Block while 'E' means Ending Point. \r\n        // E__\r\n        // |  |\r\n        // |__|\r\n        // |  B\r\n        // |__|\r\n        //    S\r\n        try {\r\n            if (!front_left_upper_block.piece)\r\n                front_left_upper = this.board.getPointFromCoordinates(X_coor - 1, Y_coor - 2);\r\n        }\r\n        catch (e) {\r\n            console.log(e);\r\n        }\r\n        //E____________\r\n        //|     |     |\r\n        //|_____|B____|\r\n        //            S\r\n        try {\r\n            if (!front_left_lower_block.piece)\r\n                front_left_lower = this.board.getPointFromCoordinates(X_coor - 2, Y_coor - 1);\r\n        }\r\n        catch (e) {\r\n            console.log(e);\r\n        }\r\n        //   __E\r\n        //  |  |\r\n        //  |__|\r\n        //  B  |\r\n        //  |__|\r\n        // S   \r\n        try {\r\n            if (!front_right_upper_block.piece)\r\n                front_right_upper = this.board.getPointFromCoordinates(X_coor + 1, Y_coor - 2);\r\n        }\r\n        catch (e) {\r\n            console.log(e);\r\n        }\r\n        // ___________E\r\n        //|     |     |\r\n        //|_____|_____|\r\n        //S     B     \r\n        try {\r\n            if (!front_right_lower_block.piece)\r\n                front_right_lower = this.board.getPointFromCoordinates(X_coor + 2, Y_coor - 1);\r\n        }\r\n        catch (e) {\r\n            console.log(e);\r\n        }\r\n        // ==========================================================\r\n        // _____B_____S\r\n        //|     |     |\r\n        //|_____|_____|\r\n        //E           \r\n        try {\r\n            if (!back_left_upper_block.piece)\r\n                back_left_upper = this.board.getPointFromCoordinates(X_coor - 2, Y_coor + 1);\r\n        }\r\n        catch (e) {\r\n            console.log(e);\r\n        }\r\n        //  __S\r\n        // |  |\r\n        // |__|\r\n        // |  B\r\n        // |__|\r\n        // E   \r\n        try {\r\n            if (!back_left_lower_block.piece)\r\n                back_left_lower = this.board.getPointFromCoordinates(X_coor - 1, Y_coor + 2);\r\n        }\r\n        catch (e) {\r\n            console.log(e);\r\n        }\r\n        //  S__\r\n        //  |  |\r\n        //  |__|\r\n        //  B  |\r\n        //  |__|\r\n        //     E\r\n        try {\r\n            if (!back_right_lower_block.piece)\r\n                back_right_lower = this.board.getPointFromCoordinates(X_coor + 1, Y_coor + 2);\r\n        }\r\n        catch (e) {\r\n            console.log(e);\r\n        }\r\n        //S_____B_____\r\n        //|     |     |\r\n        //|_____|_____|\r\n        //            E\r\n        try {\r\n            if (!back_right_upper_block.piece)\r\n                back_right_upper = this.board.getPointFromCoordinates(X_coor + 2, Y_coor + 1);\r\n        }\r\n        catch (e) {\r\n            console.log(e);\r\n        }\r\n        var movable_points_in_this_column = [];\r\n        //  __ __   \r\n        // |__|__|\r\n        // |__|__|\r\n        // \r\n        console.log(\"++++++++++++++++++++++ debug +++++++++++++++++++++++\");\r\n        console.log(front_left_upper);\r\n        console.log(front_left_lower);\r\n        console.log(front_right_upper);\r\n        console.log(front_right_lower);\r\n        console.log(back_left_upper);\r\n        console.log(back_left_lower);\r\n        // 左前-上\r\n        if (front_left_upper && this.isValidPosition(front_left_upper)) {\r\n            movable_points_in_this_column.push(front_left_upper);\r\n        }\r\n        // 左前-下\r\n        if (front_left_lower && this.isValidPosition(front_left_lower)) {\r\n            movable_points_in_this_column.push(front_left_lower);\r\n        }\r\n        // 右前-上\r\n        if (front_right_upper && this.isValidPosition(front_right_upper)) {\r\n            movable_points_in_this_column.push(front_right_upper);\r\n        }\r\n        // 右前-下\r\n        if (front_right_lower && this.isValidPosition(front_right_lower)) {\r\n            movable_points_in_this_column.push(front_right_lower);\r\n        }\r\n        // 左后-上\r\n        if (back_left_upper && this.isValidPosition(back_left_upper)) {\r\n            movable_points_in_this_column.push(back_left_upper);\r\n        }\r\n        // 左后-下\r\n        if (back_left_lower && this.isValidPosition(back_left_lower)) {\r\n            movable_points_in_this_column.push(back_left_lower);\r\n        }\r\n        // 右后-上\r\n        if (back_right_upper && this.isValidPosition(back_right_upper)) {\r\n            movable_points_in_this_column.push(back_right_upper);\r\n        }\r\n        // 右后-下\r\n        if (back_right_lower && this.isValidPosition(back_right_lower)) {\r\n            movable_points_in_this_column.push(back_right_lower);\r\n        }\r\n        console.log(\"========================= movable_points_in_this_column\");\r\n        console.log(movable_points_in_this_column);\r\n        return movable_points_in_this_column;\r\n    };\r\n    return Knight;\r\n}(ChessPiece_1.Piece));\r\nvar BlackKnight = /** @class */ (function (_super) {\r\n    __extends(BlackKnight, _super);\r\n    function BlackKnight(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.BLACK) || this;\r\n        _this.elem.src = '../img/pieces/black-ma.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        $(_this.elem).on('click', function () {\r\n            _super.prototype.movablePoints.call(_this);\r\n        });\r\n        return _this;\r\n    }\r\n    return BlackKnight;\r\n}(Knight));\r\nexports.BlackKnight = BlackKnight;\r\nvar RedKnight = /** @class */ (function (_super) {\r\n    __extends(RedKnight, _super);\r\n    function RedKnight(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.RED) || this;\r\n        _this.elem.src = '../img/pieces/red-ma.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        $(_this.elem).on('click', function () {\r\n            _super.prototype.movablePoints.call(_this);\r\n        });\r\n        return _this;\r\n    }\r\n    return RedKnight;\r\n}(Knight));\r\nexports.RedKnight = RedKnight;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BlackPawn = exports.RedPawn = void 0;\r\nvar ChessPiece_1 = require(\"./ChessPiece\");\r\nvar Pawn = /** @class */ (function (_super) {\r\n    __extends(Pawn, _super);\r\n    function Pawn(point, board, color) {\r\n        return _super.call(this, point, board, ChessPiece_1.PieceRole.Soldier, color) || this;\r\n    }\r\n    /**\r\n     *\r\n     * @param x\r\n     * @param y\r\n     * @returns boolean to indicate if the pass in coordinate is valid general position\r\n     */\r\n    Pawn.prototype.canMove = function (dest) {\r\n        var x = dest.x_coor;\r\n        var y = dest.y_coor;\r\n        //If the dest is not inside of the \"田\" shaped space of the board\r\n        //Returns false.\r\n        // if (!this.isValidGeneralPosition(x, y))\r\n        //     return false;\r\n        //If the place is outside of reach from the General,\r\n        //It returns false.\r\n        if (Math.abs(x - this.point.x_coor) > 1 || Math.abs(y - this.point.y_coor) > 1)\r\n            return false;\r\n        // We will add more logic for checking valid move later\r\n        // Current check is only for a valid position and no same side piece\r\n        return !_super.prototype.checkSameColorPieceInPoint.call(this, dest);\r\n    };\r\n    Pawn.prototype.isValidPawnPosition = function (targetPoint) {\r\n        return (targetPoint.getY() >= 1) && (targetPoint.getY() <= 10) && (targetPoint.getX() >= 1) && (targetPoint.getX() <= 9);\r\n    };\r\n    return Pawn;\r\n}(ChessPiece_1.Piece));\r\nvar RedPawn = /** @class */ (function (_super) {\r\n    __extends(RedPawn, _super);\r\n    function RedPawn(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.RED) || this;\r\n        _this.elem.src = '../img/pieces/red-bing.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        return _this;\r\n    }\r\n    RedPawn.prototype.movablePoints = function () {\r\n        var moveable_points = [];\r\n        if (this.point.getY() <= 5) {\r\n            console.log(\"过河后\");\r\n            moveable_points = moveable_points.concat(this.afterLanding());\r\n        }\r\n        else if (this.point.getY() >= 6) {\r\n            console.log(\"过河前\");\r\n            moveable_points = moveable_points.concat(this.beforeLanding());\r\n        }\r\n        return moveable_points;\r\n    };\r\n    // 渡河之前\r\n    RedPawn.prototype.beforeLanding = function () {\r\n        var X_coor = this.point.getX();\r\n        var Y_coor = this.point.getY();\r\n        var front = this.board.getPointFromCoordinates(X_coor, Y_coor - 1);\r\n        var movable_points_before_landing = [];\r\n        // 面前的格子\r\n        if (front && this.isValidPawnPosition(front)) {\r\n            movable_points_before_landing.push(front);\r\n        }\r\n        return movable_points_before_landing;\r\n    };\r\n    // 渡河以后\r\n    RedPawn.prototype.afterLanding = function () {\r\n        var X_coor = this.point.getX();\r\n        var Y_coor = this.point.getY();\r\n        var front = this.board.getPointFromCoordinates(X_coor, Y_coor - 1);\r\n        // let back = this.board.getPointFromCoordinates(X_coor, Y_coor + 1) // Not one step back!\r\n        var left = this.board.getPointFromCoordinates(X_coor - 1, Y_coor);\r\n        var right = this.board.getPointFromCoordinates(X_coor + 1, Y_coor);\r\n        var movable_points_after_landing = [];\r\n        // 面前的格子\r\n        if (front && this.isValidPawnPosition(front)) {\r\n            movable_points_after_landing.push(front);\r\n        }\r\n        // 左边 \r\n        if (left && this.isValidPawnPosition(left)) {\r\n            console.log('back.getPiece()');\r\n            console.log(left.getPiece());\r\n            movable_points_after_landing.push(left);\r\n        }\r\n        // 右边\r\n        if (right && this.isValidPawnPosition(right)) {\r\n            console.log('back.getPiece()');\r\n            console.log(right.getPiece());\r\n            movable_points_after_landing.push(right);\r\n        }\r\n        return movable_points_after_landing;\r\n    };\r\n    return RedPawn;\r\n}(Pawn));\r\nexports.RedPawn = RedPawn;\r\nvar BlackPawn = /** @class */ (function (_super) {\r\n    __extends(BlackPawn, _super);\r\n    function BlackPawn(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.BLACK) || this;\r\n        _this.elem.src = '../img/pieces/black-zu.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        return _this;\r\n    }\r\n    BlackPawn.prototype.movablePoints = function () {\r\n        var moveable_points = [];\r\n        if (this.point.getY() <= 5) {\r\n            console.log(\"过河前\");\r\n            moveable_points = moveable_points.concat(this.beforeLanding());\r\n        }\r\n        else if (this.point.getY() >= 6) {\r\n            console.log(\"过河后\");\r\n            moveable_points = moveable_points.concat(this.afterLanding());\r\n        }\r\n        return moveable_points;\r\n    };\r\n    // 渡河之前\r\n    BlackPawn.prototype.beforeLanding = function () {\r\n        var X_coor = this.point.getX();\r\n        var Y_coor = this.point.getY();\r\n        var front = this.board.getPointFromCoordinates(X_coor, Y_coor + 1);\r\n        var movable_points_before_landing = [];\r\n        // 面前的格子\r\n        if (front && this.isValidPawnPosition(front)) {\r\n            movable_points_before_landing.push(front);\r\n        }\r\n        return movable_points_before_landing;\r\n    };\r\n    // 渡河以后\r\n    BlackPawn.prototype.afterLanding = function () {\r\n        var X_coor = this.point.getX();\r\n        var Y_coor = this.point.getY();\r\n        var front = this.board.getPointFromCoordinates(X_coor, Y_coor + 1);\r\n        // let back = this.board.getPointFromCoordinates(X_coor, Y_coor + 1) // Not one step back!\r\n        var left = this.board.getPointFromCoordinates(X_coor - 1, Y_coor);\r\n        var right = this.board.getPointFromCoordinates(X_coor + 1, Y_coor);\r\n        var movable_points_after_landing = [];\r\n        // 面前的格子\r\n        if (front && this.isValidPawnPosition(front)) {\r\n            movable_points_after_landing.push(front);\r\n        }\r\n        // 左边 \r\n        if (left && this.isValidPawnPosition(left)) {\r\n            console.log('back.getPiece()');\r\n            console.log(left.getPiece());\r\n            movable_points_after_landing.push(left);\r\n        }\r\n        // 右边\r\n        if (right && this.isValidPawnPosition(right)) {\r\n            console.log('back.getPiece()');\r\n            console.log(right.getPiece());\r\n            movable_points_after_landing.push(right);\r\n        }\r\n        return movable_points_after_landing;\r\n    };\r\n    return BlackPawn;\r\n}(Pawn));\r\nexports.BlackPawn = BlackPawn;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BlackRook = exports.RedRook = void 0;\r\nvar Util_1 = __importDefault(require(\"../../../src/Util\"));\r\nvar ChessPiece_1 = require(\"./ChessPiece\");\r\nvar Rook = /** @class */ (function (_super) {\r\n    __extends(Rook, _super);\r\n    function Rook(point, board, color) {\r\n        return _super.call(this, point, board, ChessPiece_1.PieceRole.Chariot, color) || this;\r\n    }\r\n    Rook.prototype.canMove = function (dest) {\r\n        var x = dest.x_coor;\r\n        var y = dest.y_coor;\r\n        //If the dest is not inside of the \"田\" shaped space of the board\r\n        //Returns false.\r\n        if (!this.isValidChariotPosition(x, y))\r\n            return false;\r\n        //If the place is outside of reach from the General,\r\n        //It returns false.\r\n        if (Math.abs(x - this.point.x_coor) > 1 || Math.abs(y - this.point.y_coor) > 1)\r\n            return false;\r\n        // We will add more logic for checking valid move later\r\n        // Current check is only for a valid position and no same side piece\r\n        return !_super.prototype.checkSameColorPieceInPoint.call(this, dest);\r\n    };\r\n    return Rook;\r\n}(ChessPiece_1.Piece));\r\nvar RedRook = /** @class */ (function (_super) {\r\n    __extends(RedRook, _super);\r\n    function RedRook(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.RED) || this;\r\n        _this.elem.src = '../img/pieces/red-ju.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        $(_this.elem).on('click', function () {\r\n            // Log.trace(\"invoked this.checkColumns()\")\r\n            // Log.trace(this.checkColumn())\r\n            // Log.trace(this.checkRow())\r\n            _this.movablePoints();\r\n        });\r\n        return _this;\r\n    }\r\n    RedRook.prototype.movablePoints = function () {\r\n        // Log.trace('inside this.movablePoints()')\r\n        var moveable_points = [];\r\n        // moveable_points.length = 0;\r\n        moveable_points = moveable_points.concat(this.checkRow());\r\n        moveable_points = moveable_points.concat(this.checkColumn());\r\n        // Log.trace('moveable_points is empty here !!!!')\r\n        // Log.trace(moveable_points)\r\n        return moveable_points;\r\n    };\r\n    //returns the grids that General can go in a column\r\n    RedRook.prototype.checkColumn = function () {\r\n        Util_1.default.trace(\"in checkColumns\");\r\n        var Y_coor = this.point.y_coor;\r\n        var X_coor = this.point.x_coor;\r\n        var piece_col = this.board.getColFromXCoordinate(this.point.x_coor); //Checks the points in this column\r\n        var piece_row = this.board.getRowFromYCoordinate(this.point.y_coor); //Checks the points in this row\r\n        var start_flag = 0; //row 1\r\n        var end_flag = 9; //row 10 \r\n        //trasversing the column (Point [])\r\n        for (var index in piece_col) {\r\n            //if the piece in that point is not null, do some checking\r\n            if (piece_col[index].piece != null) {\r\n                //checks the indices that are smaller than the point\r\n                if (parseInt(index) < Y_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_col[index].piece.color == ChessPiece_1.PlayerColor.RED)\r\n                        start_flag = parseInt(index) + 1; // the index is not added, but the next one is.\r\n                    else\r\n                        start_flag = parseInt(index);\r\n                    if (start_flag === Y_coor - 1) // if a friendly piece is blocking right abovbe it\r\n                        start_flag = Y_coor; // start_flag is set to the next row \r\n                    // Log.trace(\"start_flag:\" + start_flag)\r\n                }\r\n                //checks those larger than that point\r\n                else if (parseInt(index) > Y_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_col[index].piece.color == ChessPiece_1.PlayerColor.RED)\r\n                        end_flag = parseInt(index) - 1; // the index is not added, but the last one is.\r\n                    else\r\n                        end_flag = parseInt(index);\r\n                    if (end_flag === Y_coor - 1) // if a friendly piece is blocking right below it\r\n                        end_flag = Y_coor - 2; // start_flag is set to the next row \r\n                    // Log.trace(\"end_flag:\" + end_flag)\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // an array to store all the movable points in a column\r\n        var movable_points_in_this_column = [];\r\n        for (var i = start_flag; i <= end_flag; i++) {\r\n            //If the coordinate is the one that piece is in\r\n            //It does not push it into the array.\r\n            if (Y_coor - 1 === i) {\r\n                // Log.trace('skip');\r\n                continue;\r\n            }\r\n            movable_points_in_this_column.push(piece_col[i]);\r\n        }\r\n        return movable_points_in_this_column;\r\n        // console.log(this.board.getColFromXCoordinate(X_coor));\r\n    };\r\n    //returns the grids that the General can go in a row\r\n    RedRook.prototype.checkRow = function () {\r\n        Util_1.default.trace(\"in checkRows()\");\r\n        // let Y_coor = this.point.y_coor\r\n        var X_coor = this.point.x_coor;\r\n        // let piece_col = this.board.getColFromXCoordinate(this.point.x_coor); //Checks the points in this column\r\n        var piece_row = this.board.getRowFromYCoordinate(this.point.y_coor); //Checks the points in this row\r\n        var start_flag = 0;\r\n        var end_flag = 8;\r\n        //trasversing the column (Point [])\r\n        for (var index in piece_row) {\r\n            //if the piece in that point is not null, do some checking\r\n            // 判定敌友\r\n            if (piece_row[index].piece != null) {\r\n                //checks the indices that are smaller than the point\r\n                // 车的左边\r\n                if (parseInt(index) < X_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_row[index].piece.color == ChessPiece_1.PlayerColor.RED)\r\n                        start_flag = parseInt(index) + 1; // the index is not added, but the next one is.\r\n                    else\r\n                        start_flag = parseInt(index);\r\n                    if (start_flag === X_coor - 1) // if a friendly piece is blocking right above it\r\n                        start_flag = X_coor; // start_flag is set to the next row \r\n                    Util_1.default.trace(\"start_flag:\" + start_flag);\r\n                }\r\n                //checks those larger than that point\r\n                else if (parseInt(index) > X_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_row[index].piece.color == ChessPiece_1.PlayerColor.RED)\r\n                        end_flag = parseInt(index) - 1; // the index is not added, but the last one is.\r\n                    else\r\n                        end_flag = parseInt(index);\r\n                    if (end_flag === X_coor - 1) // if a friendly piece is blocking right below it\r\n                        end_flag = X_coor - 2; // start_flag is set to the next row \r\n                    Util_1.default.trace(\"end_flag:\" + end_flag);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // an array to store all the movable points in a column\r\n        var movable_points_in_this_row = [];\r\n        for (var i = start_flag; i <= end_flag; i++) {\r\n            //If the coordinate is the one that piece is in\r\n            //It does not push it into the array.\r\n            if (X_coor - 1 === i) {\r\n                // Log.trace('skip');\r\n                continue;\r\n            }\r\n            movable_points_in_this_row.push(piece_row[i]);\r\n        }\r\n        return movable_points_in_this_row;\r\n    };\r\n    RedRook.prototype.isValidChariotPosition = function (x, y) {\r\n        return (y >= 8) && (y <= 10) && (x >= 4) && (x <= 6);\r\n        // && !(x > 0 && y > 0);\r\n    };\r\n    return RedRook;\r\n}(Rook));\r\nexports.RedRook = RedRook;\r\nvar BlackRook = /** @class */ (function (_super) {\r\n    __extends(BlackRook, _super);\r\n    function BlackRook(board, point) {\r\n        var _this = _super.call(this, point, board, ChessPiece_1.PlayerColor.BLACK) || this;\r\n        _this.elem.src = '../img/pieces/black-ju.png';\r\n        _this.board = board;\r\n        _this.point.setPiece(_this); //sets the piece to the point.\r\n        $(_this.elem).on('click', function () {\r\n            // Log.trace(\"invoked this.checkColumns()\")\r\n            // Log.trace(this.checkColumn())\r\n            // Log.trace(this.checkRow())\r\n            _this.movablePoints();\r\n        });\r\n        return _this;\r\n    }\r\n    BlackRook.prototype.movablePoints = function () {\r\n        // Log.trace('inside this.movablePoints()')\r\n        var moveable_points = [];\r\n        // moveable_points.length = 0;\r\n        moveable_points = moveable_points.concat(this.checkRow());\r\n        moveable_points = moveable_points.concat(this.checkColumn());\r\n        // Log.trace('moveable_points is empty here !!!!')\r\n        // Log.trace(moveable_points)\r\n        return moveable_points;\r\n    };\r\n    //returns the grids that General can go in a column\r\n    BlackRook.prototype.checkColumn = function () {\r\n        Util_1.default.trace(\"in checkColumns\");\r\n        Util_1.default.trace(\"Chariots\");\r\n        var Y_coor = this.point.y_coor;\r\n        // let X_coor = this.point.x_coor\r\n        var piece_col = this.board.getColFromXCoordinate(this.point.x_coor); //Checks the points in this column\r\n        // let piece_row = this.board.getRowFromYCoordinate(this.point.y_coor);//Checks the points in this row\r\n        var start_flag = 0; //row 1\r\n        var end_flag = 9; //row 10 \r\n        //trasversing the column (Point [])\r\n        for (var index in piece_col) {\r\n            Util_1.default.trace('piece_col:');\r\n            Util_1.default.trace(piece_col);\r\n            //if the piece in that point is not null, do some checking\r\n            if (piece_col[index].piece != null) {\r\n                Util_1.default.trace(\"有棋子\");\r\n                //checks the indices that are smaller than the point\r\n                // 这颗待处理棋子在上方\r\n                if (parseInt(index) < Y_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_col[index].piece.color == ChessPiece_1.PlayerColor.BLACK) {\r\n                        Util_1.default.trace(\"队友在上方\");\r\n                        start_flag = parseInt(index) + 1; // the index is not added, but the next one is.\r\n                    }\r\n                    else if (piece_col[index].piece.color != ChessPiece_1.PlayerColor.BLACK) {\r\n                        start_flag = parseInt(index);\r\n                        console.log(\"debugging...........................\");\r\n                        console.log(start_flag);\r\n                    }\r\n                    if (start_flag === Y_coor - 1) // if a friendly piece is blocking right abovbe it\r\n                        start_flag = Y_coor; // start_flag is set to the next row \r\n                    // Log.trace(\"start_flag:\" + start_flag)\r\n                }\r\n                //checks those larger than that point\r\n                // 这颗待处理棋子在下方\r\n                else if (parseInt(index) > Y_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_col[index].piece.color == ChessPiece_1.PlayerColor.BLACK)\r\n                        end_flag = parseInt(index) - 1; // the index is not added, but the last one is.\r\n                    // 是敌方棋子的话：\r\n                    else if (piece_col[index].piece.color != ChessPiece_1.PlayerColor.BLACK)\r\n                        end_flag = parseInt(index);\r\n                    if (end_flag === Y_coor - 1) // if a friendly piece is blocking right below it\r\n                        end_flag = Y_coor - 2; // start_flag is set to the next row \r\n                    // Log.trace(\"end_flag:\" + end_flag)\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // an array to store all the movable points in a column\r\n        var movable_points_in_this_column = [];\r\n        for (var i = start_flag; i <= end_flag; i++) {\r\n            //If the coordinate is the one that piece is in\r\n            //It does not push it into the array.\r\n            if (Y_coor - 1 === i) {\r\n                // Log.trace('skip');\r\n                continue;\r\n            }\r\n            movable_points_in_this_column.push(piece_col[i]);\r\n        }\r\n        console.log(movable_points_in_this_column);\r\n        return movable_points_in_this_column;\r\n        // console.log(this.board.getColFromXCoordinate(X_coor));\r\n    };\r\n    //returns the grids that the General can go in a row\r\n    BlackRook.prototype.checkRow = function () {\r\n        Util_1.default.trace(\"in checkRows()\");\r\n        // let Y_coor = this.point.y_coor\r\n        var X_coor = this.point.x_coor;\r\n        // let piece_col = this.board.getColFromXCoordinate(this.point.x_coor); //Checks the points in this column\r\n        var piece_row = this.board.getRowFromYCoordinate(this.point.y_coor); //Checks the points in this row\r\n        var start_flag = 0;\r\n        var end_flag = 8;\r\n        //trasversing the column (Point [])\r\n        //遍历横行\r\n        for (var index in piece_row) {\r\n            //if the piece in that point is not null, do some checking\r\n            //发现该点内有棋子，判断是敌是友\r\n            if (piece_row[index].piece != null) {\r\n                Util_1.default.trace(\"有棋子\");\r\n                Util_1.default.trace(piece_row);\r\n                //checks the indices that are smaller than the point\r\n                // 该枚车的左边\r\n                if (parseInt(index) < X_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_row[index].piece.color == ChessPiece_1.PlayerColor.BLACK) {\r\n                        console.log(\"---------------------------------debug-----------------------------\");\r\n                        start_flag = parseInt(index) + 1; // the index is not added, but the next one is.\r\n                    }\r\n                    else\r\n                        start_flag = parseInt(index);\r\n                    if (start_flag === X_coor - 1) // if a friendly piece is blocking immediately left to it\r\n                        start_flag = X_coor; // start_flag is set to the next row \r\n                    Util_1.default.trace(\"start_flag:\" + start_flag);\r\n                }\r\n                //checks those larger than that point\r\n                // 检查该车的右边\r\n                else if (parseInt(index) > X_coor - 1) {\r\n                    //if the point holds a friendly piece:\r\n                    if (piece_row[index].piece.color == ChessPiece_1.PlayerColor.BLACK)\r\n                        end_flag = parseInt(index) - 1; // Friendly blocking: the index is not added, but the previous one is.\r\n                    else\r\n                        end_flag = parseInt(index);\r\n                    if (end_flag === X_coor - 1) // if a friendly piece is blocking right below it\r\n                        end_flag = X_coor - 2; // start_flag is set to the next row \r\n                    Util_1.default.trace(\"end_flag:\" + end_flag);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // an array to store all the movable points in a column\r\n        var movable_points_in_this_row = [];\r\n        for (var i = start_flag; i <= end_flag; i++) {\r\n            //If the coordinate is the one that piece is in\r\n            //It does not push it into the array.\r\n            if (X_coor - 1 === i) {\r\n                continue;\r\n            }\r\n            movable_points_in_this_row.push(piece_row[i]);\r\n        }\r\n        console.log(movable_points_in_this_row);\r\n        return movable_points_in_this_row;\r\n    };\r\n    BlackRook.prototype.isValidChariotPosition = function (x, y) {\r\n        return (y >= 0) && (y <= 10) && (x >= 0) && (x <= 9);\r\n        // && !(x > 0 && y > 0);\r\n    };\r\n    return BlackRook;\r\n}(Rook));\r\nexports.BlackRook = BlackRook;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Game = void 0;\r\nvar Boards_1 = require(\"./Boards\");\r\nvar Rook_1 = require(\"./ChessPieces/Rook\");\r\nvar frontend_utils_1 = require(\"./frontend-utils\");\r\nvar King_1 = require(\"./ChessPieces/King\");\r\nvar Cannon_1 = require(\"./ChessPieces/Cannon\");\r\nvar Pawn_1 = require(\"./ChessPieces/Pawn\");\r\nvar Advisor_1 = require(\"./ChessPieces/Advisor\");\r\nvar Bishop_1 = require(\"./ChessPieces/Bishop\");\r\nvar Knight_1 = require(\"./ChessPieces/Knight\");\r\nvar Game = /** @class */ (function () {\r\n    function Game() {\r\n        this.chess_pieces = []; // 所有的棋子放进Array里面，便于删除\r\n        this.currentPlayer = frontend_utils_1.PlayerColor.RED;\r\n        this.board = new Boards_1.Board(this);\r\n        this.full_move_counts = 1;\r\n    }\r\n    // gets the public player\r\n    // 获取当前玩家\r\n    Game.prototype.getCurrentPlayer = function () {\r\n        return this.currentPlayer;\r\n    };\r\n    //Switch current player to the other player\r\n    //到另一个人下\r\n    Game.prototype.alternatePlayer = function () {\r\n        if (this.currentPlayer === frontend_utils_1.PlayerColor.RED) {\r\n            this.full_move_counts++; //轮到红棋移动的时候，步数+1\r\n            this.currentPlayer = frontend_utils_1.PlayerColor.BLACK;\r\n        }\r\n        else {\r\n            this.currentPlayer = frontend_utils_1.PlayerColor.RED;\r\n        }\r\n    };\r\n    Game.prototype.initializePieces = function () {\r\n        // ============================= 棋子初始化 Initialization of ChessPieces =====================================================\r\n        //                               先横坐标后纵坐标\r\n        //                              1 2 3 4 5 6 7 8 9\r\n        //                              2\r\n        //                              3\r\n        //                              4\r\n        //                              5\r\n        //                              6\r\n        //                              7\r\n        //                              8\r\n        //                              9\r\n        //                              10\r\n        // 将/帅   Generals:\r\n        var red_shuai = new King_1.RedKing(this.board, this.board.getPointFromCoordinates(5, 10)); //new Point() doesn't make sense.\r\n        var black_jiang = new King_1.BlackKing(this.board, this.board.getPointFromCoordinates(5, 1)); // using getPoint from coor now\r\n        this.chess_pieces.push(red_shuai);\r\n        this.chess_pieces.push(black_jiang);\r\n        // 红车    Red Chariots\r\n        var red_ju_one = new Rook_1.RedRook(this.board, this.board.getPointFromCoordinates(1, 10));\r\n        var red_ju_two = new Rook_1.RedRook(this.board, this.board.getPointFromCoordinates(9, 10));\r\n        this.chess_pieces.push(red_ju_one);\r\n        this.chess_pieces.push(red_ju_two);\r\n        // 黑车  Black Chariots\r\n        var black_ju_one = new Rook_1.BlackRook(this.board, this.board.getPointFromCoordinates(1, 1));\r\n        var black_ju_two = new Rook_1.BlackRook(this.board, this.board.getPointFromCoordinates(9, 1));\r\n        this.chess_pieces.push(black_ju_one);\r\n        this.chess_pieces.push(black_ju_two);\r\n        // 红炮 RedCannons\r\n        var red_cannon_one = new Cannon_1.RedCannon(this.board, this.board.getPointFromCoordinates(2, 8));\r\n        var red_cannon_two = new Cannon_1.RedCannon(this.board, this.board.getPointFromCoordinates(8, 8));\r\n        this.chess_pieces.push(red_cannon_one);\r\n        this.chess_pieces.push(red_cannon_two);\r\n        // 黑炮 BlackCannon\r\n        var black_cannon_one = new Cannon_1.BlackCannon(this.board, this.board.getPointFromCoordinates(2, 3));\r\n        var black_cannon_two = new Cannon_1.BlackCannon(this.board, this.board.getPointFromCoordinates(8, 3));\r\n        this.chess_pieces.push(black_cannon_one);\r\n        this.chess_pieces.push(black_cannon_two);\r\n        // 兵、卒 P/p\r\n        var red_bing_one = new Pawn_1.RedPawn(this.board, this.board.getPointFromCoordinates(1, 7));\r\n        var red_bing_two = new Pawn_1.RedPawn(this.board, this.board.getPointFromCoordinates(3, 7));\r\n        var red_bing_three = new Pawn_1.RedPawn(this.board, this.board.getPointFromCoordinates(5, 7));\r\n        var red_bing_four = new Pawn_1.RedPawn(this.board, this.board.getPointFromCoordinates(7, 7));\r\n        var red_bing_five = new Pawn_1.RedPawn(this.board, this.board.getPointFromCoordinates(9, 7));\r\n        this.chess_pieces.push(red_bing_one);\r\n        this.chess_pieces.push(red_bing_two);\r\n        this.chess_pieces.push(red_bing_three);\r\n        this.chess_pieces.push(red_bing_four);\r\n        this.chess_pieces.push(red_bing_five);\r\n        var black_zu_one = new Pawn_1.BlackPawn(this.board, this.board.getPointFromCoordinates(1, 4));\r\n        var black_zu_two = new Pawn_1.BlackPawn(this.board, this.board.getPointFromCoordinates(3, 4));\r\n        var black_zu_three = new Pawn_1.BlackPawn(this.board, this.board.getPointFromCoordinates(5, 4));\r\n        var black_zu_four = new Pawn_1.BlackPawn(this.board, this.board.getPointFromCoordinates(7, 4));\r\n        var black_zu_five = new Pawn_1.BlackPawn(this.board, this.board.getPointFromCoordinates(9, 4));\r\n        this.chess_pieces.push(black_zu_one);\r\n        this.chess_pieces.push(black_zu_two);\r\n        this.chess_pieces.push(black_zu_three);\r\n        this.chess_pieces.push(black_zu_four);\r\n        this.chess_pieces.push(black_zu_five);\r\n        // 红士 A\r\n        var red_advisor_one = new Advisor_1.RedAdvisor(this.board, this.board.getPointFromCoordinates(4, 10));\r\n        var red_advisor_two = new Advisor_1.RedAdvisor(this.board, this.board.getPointFromCoordinates(6, 10));\r\n        this.chess_pieces.push(red_advisor_one);\r\n        this.chess_pieces.push(red_advisor_two);\r\n        // 黑仕 a\r\n        var black_advisor_one = new Advisor_1.BlackAdvisor(this.board, this.board.getPointFromCoordinates(4, 1));\r\n        var black_advisor_two = new Advisor_1.BlackAdvisor(this.board, this.board.getPointFromCoordinates(6, 1));\r\n        this.chess_pieces.push(black_advisor_one);\r\n        this.chess_pieces.push(black_advisor_two);\r\n        // 黑象 b\r\n        var black_elephant_one = new Bishop_1.BlackWarElephant(this.board, this.board.getPointFromCoordinates(3, 1));\r\n        var black_elephant_two = new Bishop_1.BlackWarElephant(this.board, this.board.getPointFromCoordinates(7, 1));\r\n        this.chess_pieces.push(black_elephant_one);\r\n        this.chess_pieces.push(black_elephant_two);\r\n        // 红象 B\r\n        var red_elephant_one = new Bishop_1.RedWarElephant(this.board, this.board.getPointFromCoordinates(3, 10));\r\n        var red_elephant_two = new Bishop_1.RedWarElephant(this.board, this.board.getPointFromCoordinates(7, 10));\r\n        this.chess_pieces.push(red_elephant_one);\r\n        this.chess_pieces.push(red_elephant_two);\r\n        // 黑马 n\r\n        var black_calvalry_one = new Knight_1.BlackKnight(this.board, this.board.getPointFromCoordinates(2, 1));\r\n        var black_calvalry_two = new Knight_1.BlackKnight(this.board, this.board.getPointFromCoordinates(8, 1));\r\n        this.chess_pieces.push(black_calvalry_one);\r\n        this.chess_pieces.push(black_calvalry_two);\r\n        // 红马 N\r\n        var red_calvalry_one = new Knight_1.RedKnight(this.board, this.board.getPointFromCoordinates(2, 10));\r\n        var red_calvalry_two = new Knight_1.RedKnight(this.board, this.board.getPointFromCoordinates(8, 10));\r\n        this.chess_pieces.push(red_calvalry_one);\r\n        this.chess_pieces.push(red_calvalry_two);\r\n        // ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 棋子初始化 Initialization of ChessPieces ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n        // forEach 渲染法\r\n        for (var _i = 0, _a = this.chess_pieces; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            item.render();\r\n        }\r\n    };\r\n    // 删除所有的棋子\r\n    Game.prototype.destroyPieces = function () {\r\n        // forEach 删除法\r\n        for (var _i = 0, _a = this.chess_pieces; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            item.destroy();\r\n        }\r\n    };\r\n    Game.prototype.render = function () {\r\n        this.board.render(); // 渲染棋盘\r\n        this.initializePieces(); // 渲染棋子\r\n    };\r\n    Game.prototype.restart = function () {\r\n        this.destroyPieces();\r\n        this.initializePieces();\r\n    };\r\n    Game.prototype.getFullMoveCounts = function () {\r\n        return this.full_move_counts;\r\n    };\r\n    return Game;\r\n}());\r\nexports.Game = Game;\r\nvar game = new Game();\r\ngame.render();\r\n// game.destroy();\r\n(0, frontend_utils_1.fitSize)();\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PlayerColor = exports.SIDE_LENGTH_vw = exports.SIDE_LENGTH = exports.Point = exports.fitSize = exports.getChessBoardSize = exports.getZoomedRatio = void 0;\r\nvar Util_1 = __importDefault(require(\"../../src/Util\"));\r\n// // used in class Piece\r\n// enum PieceColor {\r\n//     'black',\r\n//     'red'\r\n// }\r\n// used in class Game, \r\nvar PlayerColor;\r\n(function (PlayerColor) {\r\n    PlayerColor[PlayerColor[\"BLACK\"] = 0] = \"BLACK\";\r\n    PlayerColor[PlayerColor[\"RED\"] = 1] = \"RED\";\r\n    PlayerColor[PlayerColor[\"NEUTRAL\"] = 2] = \"NEUTRAL\";\r\n    PlayerColor[PlayerColor[\"SPECTATOR\"] = 3] = \"SPECTATOR\"; // Cannot control either side. 双方都不可以控制\r\n})(PlayerColor || (PlayerColor = {}));\r\nexports.PlayerColor = PlayerColor;\r\n// 得到当前的放大倍率\r\nfunction getZoomedRatio() {\r\n    var ratio = 0;\r\n    if (window.devicePixelRatio !== undefined) {\r\n        ratio = window.devicePixelRatio;\r\n    }\r\n    else if (window.outerWidth !== undefined && window.innerWidth !== undefined) {\r\n        ratio = window.outerWidth / window.innerWidth;\r\n    }\r\n    if (ratio) {\r\n        ratio = Math.round(ratio * 100);\r\n    }\r\n    return ratio;\r\n}\r\nexports.getZoomedRatio = getZoomedRatio;\r\n// 得到棋盘的当前大小\r\nfunction getChessBoardSize() {\r\n    Util_1.default.trace('chessboard size:');\r\n    var chessboard = $('#id_chessboard');\r\n    Util_1.default.trace('chessboad width');\r\n    Util_1.default.trace(chessboard.css('width'));\r\n    Util_1.default.trace('chessboad height');\r\n    Util_1.default.trace(chessboard.css('height'));\r\n}\r\nexports.getChessBoardSize = getChessBoardSize;\r\n// The vertical lines are known as files (Chinese: 路; pinyin: lù; \"road\")\r\n// the horizontal lines are known as ranks 线 xiàn; \"line\"\r\nvar Point = /** @class */ (function () {\r\n    function Point(col, row) {\r\n        this.UcciXCoorMap = new Map([\r\n            [1, \"a\"],\r\n            [2, \"b\"],\r\n            [3, \"c\"],\r\n            [4, \"d\"],\r\n            [5, \"e\"],\r\n            [6, \"f\"],\r\n            [7, \"g\"],\r\n            [8, \"h\"],\r\n            [9, \"i\"],\r\n        ]);\r\n        this.UcciYCoorMap = new Map([\r\n            [0, \"10\"],\r\n            [1, \"9\"],\r\n            [2, \"8\"],\r\n            [3, \"7\"],\r\n            [4, \"6\"],\r\n            [5, \"5\"],\r\n            [6, \"4\"],\r\n            [7, \"3\"],\r\n            [8, \"2\"],\r\n            [9, \"1\"],\r\n        ]);\r\n        // this.board = board;\r\n        this.x_coor = col; //col -> verticle\r\n        this.y_coor = row; //row -> horizontal\r\n        // 点所在的 UCCI  坐标\r\n        this.ucci_x_coor = this.UcciXCoorMap.get(col);\r\n        this.ucci_y_coor = this.UcciYCoorMap.get(row);\r\n        // A dummy element for initialization first and then update in method\r\n        this.elem = document.createElement('div');\r\n        this.updateElement(col, row);\r\n    }\r\n    /** when piece moves in\r\n        it binds the piece with the grid.\r\n        notice when the piece is moving out from a grid\r\n        the piece should be set to null.\r\n        @param piece: a nullable Piece object\r\n    */\r\n    Point.prototype.setPiece = function (piece) {\r\n        this.piece = piece;\r\n    };\r\n    // 判断点上是否有棋子\r\n    Point.prototype.hasPiece = function () {\r\n        return this.piece ? true : false;\r\n    };\r\n    //gets the piece in the current grid\r\n    Point.prototype.getPiece = function () {\r\n        return this.piece;\r\n    };\r\n    Point.prototype.getX = function () {\r\n        return this.x_coor;\r\n    };\r\n    Point.prototype.getY = function () {\r\n        return this.y_coor;\r\n    };\r\n    // 更新渲染\r\n    Point.prototype.updateElement = function (newCol, newRow) {\r\n        var grid_div = this.elem;\r\n        var oldCol = this.x_coor;\r\n        var oldRow = this.y_coor;\r\n        /* code previously found in board initialization, with div_2d_array\r\n           now divs are bound to specific points.\r\n        */\r\n        grid_div.id = \"grid_div_\".concat(oldCol, \"_\").concat(oldRow);\r\n        $(\"#\".concat(grid_div.id)).remove(); //must remove the original one, in order to make it unique.\r\n        grid_div.className = 'className_grid_div';\r\n        $(grid_div).css('grid-column', newCol);\r\n        $(grid_div).css('grid-row', newRow);\r\n        $('#board').append(grid_div);\r\n        // this.board.intersections[newCol-1][newRow-1] = this; //replace the original point with the newly updated point.\r\n    };\r\n    return Point;\r\n}());\r\nexports.Point = Point;\r\n//how many px when it's zoomed 100%\r\nvar SIDE_LENGTH = 75;\r\nexports.SIDE_LENGTH = SIDE_LENGTH;\r\nvar SIDE_LENGTH_vw = 70 / (getZoomedRatio() * 0.01);\r\nexports.SIDE_LENGTH_vw = SIDE_LENGTH_vw;\r\n/**\r\n * 固定大小用的function\r\n *\r\n*/\r\nfunction fitSize() {\r\n    var board = $('#board');\r\n    $.when(board)\r\n        //fiting size for the board\r\n        .then(function () {\r\n        console.log('background-size');\r\n        console.log(board.css('background-size'));\r\n        board.css('width', board.css('height'));\r\n        board.css('height', board.css('width'));\r\n        // board.css('row-gap','0px')\r\n        board.css('column-gap', '0px');\r\n        console.log(board.css('row-gap'));\r\n    })\r\n        //fiting sizes for the grids\r\n        .then(function () {\r\n        $('.className_grid_div').css('width', parseInt(board.css('width')) / 11);\r\n        $('.className_grid_div').css('height', parseInt(board.css('height')) / 10);\r\n        $('.className_grid_div').css('z-index', 10);\r\n        $('.className_grid_div').css('margin', 0);\r\n        console.log(\"board.css++++++++++++++++++++++++++\");\r\n        console.log($('.className_grid_div').css('width'));\r\n        $('#board').css(\"grid-template-columns\", \"repeat(9,\".concat($('.className_grid_div').css('width'), \")\"));\r\n        // $('#board').css(\"grid-column-gap\", '0.3em');\r\n        $('#board').css(\"column-gap\", '0.3em');\r\n        $('#board').css('justify-content', 'center');\r\n    })\r\n        //fiting sizes for the pieces\r\n        .then(function () {\r\n        $('.pieces').css('width', parseInt($('.className_grid_div').css('width')));\r\n        $('.pieces').css('height', parseInt($('.className_grid_div').css('width')));\r\n    })\r\n        .then(function () {\r\n        board.css('max-width', board.css('height'));\r\n    });\r\n}\r\nexports.fitSize = fitSize;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.FenNotation = void 0;\r\nvar FenNotation = /** @class */ (function () {\r\n    // \r\n    function FenNotation(piece_placement, active_color, \r\n    // castling_availability: string = '-',          // 中象中不存在castling，所以一直都是 \"-\"\r\n    // en_passant_end_coordinate: string = '-',      // 中象中不存在en passant，所以一直都是\"-\"\"\r\n    half_move_counter, full_move_counter) {\r\n        this.piece_placement = piece_placement; // rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/P1P1P1P1P/1C5C1/9/RNBAKABNR\r\n        this.active_color = active_color; // w\r\n        this.castling_availability = '-'; // -\r\n        this.en_passant_end_coordinate = '-'; // -\r\n        this.half_move_counter = half_move_counter; // 通常该值达到120就要判和(六十回合自然限着)，一旦形成局面的上一步是吃子，这里就标记“0”\r\n        this.full_move_counter = full_move_counter; // \r\n    }\r\n    FenNotation.prototype.getFenNotation = function () {\r\n        var ret_string = \"\".concat(this.piece_placement, \" \").concat(this.active_color, \" \").concat(this.castling_availability, \" \").concat(this.en_passant_end_coordinate, \" \").concat(this.half_move_counter, \" \").concat(this.full_move_counter);\r\n        return ret_string;\r\n    };\r\n    return FenNotation;\r\n}());\r\nexports.FenNotation = FenNotation;\r\n","\"use strict\";\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Log = /** @class */ (function () {\r\n    function Log() {\r\n    }\r\n    Log.trace = function () {\r\n        var msg = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            msg[_i] = arguments[_i];\r\n        }\r\n        console.log.apply(console, __spreadArray([\"<T> \".concat(new Date().toLocaleString(), \":\")], msg, false));\r\n    };\r\n    Log.info = function () {\r\n        var msg = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            msg[_i] = arguments[_i];\r\n        }\r\n        console.info.apply(console, __spreadArray([\"<I> \".concat(new Date().toLocaleString(), \":\")], msg, false));\r\n    };\r\n    Log.warn = function () {\r\n        var msg = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            msg[_i] = arguments[_i];\r\n        }\r\n        console.warn.apply(console, __spreadArray([\"<W> \".concat(new Date().toLocaleString(), \":\")], msg, false));\r\n    };\r\n    Log.error = function () {\r\n        var msg = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            msg[_i] = arguments[_i];\r\n        }\r\n        console.error.apply(console, __spreadArray([\"<E> \".concat(new Date().toLocaleString(), \":\")], msg, false));\r\n    };\r\n    Log.test = function () {\r\n        var msg = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            msg[_i] = arguments[_i];\r\n        }\r\n        console.log.apply(console, __spreadArray([\"<X> \".concat(new Date().toLocaleString(), \":\")], msg, false));\r\n    };\r\n    return Log;\r\n}());\r\nexports.default = Log;\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module\n__webpack_require__(20);\n// This entry module used 'exports' so it can't be inlined\n"],"sourceRoot":""}