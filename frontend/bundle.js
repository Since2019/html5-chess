(()=>{"use strict";var o={140:function(o,e,t){var i,r=this&&this.__extends||(i=function(o,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,e){o.__proto__=e}||function(o,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=e[t])})(o,e)},function(o,e){function t(){this.constructor=o}i(o,e),o.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),n=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(e,"__esModule",{value:!0}),e.BlackAdvisor=e.RedAdvisor=void 0;var a=n(t(102)),s=t(476),c=t(950),l=function(o){function e(e,t,i){return o.call(this,e,t,s.PieceRole.Advisor,i)||this}return r(e,o),e.prototype.canMove=function(e){var t=e.x_coor,i=e.y_coor;return!(Math.abs(t-this.point.x_coor)>1||Math.abs(i-this.point.y_coor)>1||o.prototype.checkSameColorPieceInPoint.call(this,e))},e}(s.Piece),d=function(o){function e(e,t){var i=o.call(this,t,e,s.PlayerColor.RED)||this;return i.elem.src="../img/pieces/red-shi.png",i.board=e,i.point.setPiece(i),i}return r(e,o),e.prototype.movablePoints=function(){var o=[];return o.concat(this.checkPeriphery())},e.prototype.checkPeriphery=function(){var o=this.point.getX(),e=this.point.getY(),t=this.board.getPointFromCoordinates(o-1,e-1),i=this.board.getPointFromCoordinates(o+1,e-1),r=new c.Point(-1,-1),n=new c.Point(-1,-1);try{r=this.board.getPointFromCoordinates(o-1,e+1),n=this.board.getPointFromCoordinates(o+1,e+1)}catch(o){a.default.trace("出错！"),console.error(o)}var s=[];return console.log("++++++++++++++++++++++ debug +++++++++++++++++++++++"),t&&this.isValidGeneralPosition(t)&&s.push(t),i&&this.isValidGeneralPosition(i)&&s.push(i),r&&this.isValidGeneralPosition(r)&&s.push(r),n&&this.isValidGeneralPosition(n)&&(console.log(n.getPiece()),s.push(n)),s},e.prototype.isValidGeneralPosition=function(o){return console.log("isValidGeneralPosition +++++++++++"),console.log(o),console.log(o.getX()),console.log(o.getY()),o.getX()>=4&&o.getX()<=6&&o.getY()>=8&&o.getY()<=10},e}(l);e.RedAdvisor=d;var h=function(o){function e(e,t){var i=o.call(this,t,e,s.PlayerColor.BLACK)||this;return i.elem.src="../img/pieces/black-shi.png",i.board=e,i.point.setPiece(i),i}return r(e,o),e.prototype.movablePoints=function(){var o=[];return o.concat(this.checkPeriphery())},e.prototype.checkPeriphery=function(){var o=this.point.getX(),e=this.point.getY(),t=this.board.getPointFromCoordinates(o+1,e+1),i=this.board.getPointFromCoordinates(o-1,e+1),r=new c.Point(-1,-1),n=new c.Point(-1,-1);try{r=this.board.getPointFromCoordinates(o+1,e-1),n=this.board.getPointFromCoordinates(o-1,e-1)}catch(o){a.default.trace("出错！"),console.error(o)}var s=[];return console.log("++++++++++++++++++++++ debug +++++++++++++++++++++++"),t&&this.isValidGeneralPosition(t)&&s.push(t),i&&this.isValidGeneralPosition(i)&&s.push(i),r&&this.isValidGeneralPosition(r)&&s.push(r),n&&this.isValidGeneralPosition(n)&&(console.log(n.getPiece()),s.push(n)),s},e.prototype.isValidGeneralPosition=function(o){return console.log("isValidGeneralPosition +++++++++++"),console.log(o),console.log(o.getX()),console.log(o.getY()),o.getX()>=4&&o.getX()<=6&&o.getY()>=1&&o.getY()<=3},e}(l);e.BlackAdvisor=h},718:(o,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Board=void 0;var i=t(950),r=function(){function o(o){this.game=o,this.ratio=100,this.side_length=.01*this.ratio*i.SIDE_LENGTH,this.target_coordinate=[-1,-1],this.intersections=new Array;for(var e=0;e<9;e++){this.intersections[e]=[];for(var t=0;t<10;t++)this.intersections[e][t]=new i.Point(e+1,t+1)}}return o.prototype.movePieceFromSrcToDest=function(o,e,t){e.setPiece(null),o.moveToPoint(t),t.setPiece(o)},o.prototype.getPointFromCoordinates=function(o,e){return this.validateXCoordinate(o)&&this.validateYCoordinate(e)?this.intersections[o-1][e-1]:null},o.prototype.getCoordinateFromElemId=function(o){console.log(o);var e=o.split("_"),t=e[2],i=e[3];return[parseInt(t),parseInt(i)]},o.prototype.validateXCoordinate=function(o){return o>=1&&o<=9},o.prototype.validateYCoordinate=function(o){return o>=1&&o<=10},o.prototype.getRowFromYCoordinate=function(o){for(var e=[],t=0;t<9;t++)e.push(this.intersections[t][o-1]);return e},o.prototype.getColFromXCoordinate=function(o){for(var e=[],t=0;t<10;t++)e.push(this.intersections[o-1][t]);return e},o.prototype.detectZoom=function(){var o=0;void 0!==window.devicePixelRatio?o=window.devicePixelRatio:void 0!==window.outerWidth&&void 0!==window.innerWidth&&(o=window.outerWidth/window.innerWidth),o&&(o=Math.round(100*o)),this.ratio=o},o.prototype.render=function(){var o=$("#board");$("#id_chessboard").css("position","fixed"),$("#id_chessboard").css("max-height","100vh"),$("#id_chessboard").css("margin","0"),$("#id_chessboard").css("padding","0vw"),o.css("margin-left","auto"),o.css("margin-right","auto"),o.css("padding",0),$(".className_grid_div").css("background-color","rgba(255,0,0,0.3)"),$(window).on("resize",(function(){i.fitSize()})),$(document).on("ready",(function(){i.fitSize()})),$("#board").css("max-width","100vh")},o}();e.Board=r},232:function(o,e,t){var i,r=this&&this.__extends||(i=function(o,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,e){o.__proto__=e}||function(o,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=e[t])})(o,e)},function(o,e){function t(){this.constructor=o}i(o,e),o.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),n=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(e,"__esModule",{value:!0}),e.BlackCannon=e.RedCannon=void 0;var a=n(t(102)),s=t(476),c=function(o){function e(e,t,i){return o.call(this,e,t,s.PieceRole.Cannon,i)||this}return r(e,o),e.prototype.isValidCannonPosition=function(o,e){return e>=0&&e<=10&&o>=0&&o<=9},e.prototype.canMove=function(e){var t=e.x_coor,i=e.y_coor;return!(!this.isValidCannonPosition(t,i)||Math.abs(t-this.point.x_coor)>1||Math.abs(i-this.point.y_coor)>1||o.prototype.checkSameColorPieceInPoint.call(this,e))},e.prototype.movablePoints=function(){var o=[];return(o=(o=(o=o.concat(this.checkRow())).concat(this.checkColumn())).concat(this.checkShellingRow())).concat(this.checkShellingCol())},e.prototype.checkShellingRow=function(){a.default.trace("in checkShelling()"),a.default.trace("Cannon");var o=this.point.x_coor,e=this.board.getRowFromYCoordinate(this.point.y_coor),t=!1,i=[];for(var r in e)if(parseInt(r)<o-1){if(a.default.trace("正在检测该棋子的左侧"),e[r].piece){if(t){i.push(e[r]);break}if(!t){t=!0;continue}}}else if(parseInt(r)>o+1&&(a.default.trace("正在检测该棋子的右侧"),e[r].piece)){if(t){i.push(e[r]);break}if(!t){t=!0;continue}}return i},e.prototype.checkShellingCol=function(){a.default.trace("in checkShelling()"),a.default.trace("Cannon");var o=this.point.y_coor,e=this.board.getColFromXCoordinate(this.point.x_coor),t=!1,i=[];for(var r in e)if(parseInt(r)<o){if(a.default.trace("正在检测该棋子的上方"),e[r].piece){if(console.log("piece_col[index]piece_col[index] ===================++"),console.log(e[r]),t){a.default.trace("有炮台了，添加以下点："),a.default.trace(e[r]),i.push(e[r]);break}if(!t){a.default.trace("无炮台"),t=!0;continue}}}else if(parseInt(r)>o&&(a.default.trace("正在检测该棋子的下方"),e[r].piece)){if(console.log("piece_col[index] ===================++"),console.log(e[r]),console.log("cornerstone_flag:"),console.log(t),1==t){a.default.trace("有炮台了，正在添加以下点："),a.default.trace(e[r]),i.push(e[r]);break}if(!t){t=!0,a.default.trace("之前无炮台，现在有炮台了。"),console.log(t);continue}}return i},e.prototype.checkColumn=function(){a.default.trace("in checkColumn()"),a.default.trace("Cannon");var o=this.point.y_coor,e=this.board.getColFromXCoordinate(this.point.x_coor),t=0,i=9;for(var r in e)if(a.default.trace("piece_col:"),a.default.trace(e),null!=e[r].piece)if(a.default.trace("有棋子"),parseInt(r)<o-1)e[r].piece.color==s.PlayerColor.BLACK?(a.default.trace("队友在上方"),t=parseInt(r)+1):e[r].piece.color!=s.PlayerColor.BLACK&&(t=parseInt(r),console.log("debugging..........................."),console.log(t)),t===o-1&&(t=o);else if(parseInt(r)>o-1){e[r].piece.color==s.PlayerColor.BLACK?i=parseInt(r)-1:e[r].piece.color!=s.PlayerColor.BLACK&&(i=parseInt(r)),i===o-1&&(i=o-2);break}for(var n=[],c=t;c<=i;c++)o-1!==c&&n.push(e[c]);return console.log(n),n},e.prototype.checkRow=function(){a.default.trace("in checkRows()");var o=this.point.x_coor,e=this.board.getRowFromYCoordinate(this.point.y_coor),t=0,i=8;for(var r in e)if(null!=e[r].piece)if(a.default.trace("有棋子"),a.default.trace(e),parseInt(r)<o-1)e[r].getPiece().isFriendly()?(console.log("---------------------------------debug-----------------------------"),t=parseInt(r)+1):t=parseInt(r),t===o-1&&(t=o),a.default.trace("start_flag:"+t);else if(parseInt(r)>o-1){(i=e[r].getPiece().isFriendly()?parseInt(r)-1:parseInt(r))===o-1&&(i=o-2),a.default.trace("end_flag:"+i);break}for(var n=[],s=t;s<=i;s++)o-1!==s&&n.push(e[s]);return console.log(n),n},e}(s.Piece),l=function(o){function e(e,t){var i=o.call(this,t,e,s.PlayerColor.BLACK)||this;return i.elem.src="../img/pieces/black-pao.png",i.board=e,i.point.setPiece(i),$(i.elem).on("click",(function(){o.prototype.movablePoints.call(i)})),i}return r(e,o),e}(c);e.BlackCannon=l;var d=function(o){function e(e,t){var i=o.call(this,t,e,s.PlayerColor.RED)||this;return i.elem.src="../img/pieces/red-pao.png",i.board=e,i.point.setPiece(i),$(i.elem).on("click",(function(){o.prototype.movablePoints.call(i)})),i}return r(e,o),e}(c);e.RedCannon=d},884:function(o,e,t){var i,r=this&&this.__extends||(i=function(o,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,e){o.__proto__=e}||function(o,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=e[t])})(o,e)},function(o,e){function t(){this.constructor=o}i(o,e),o.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),n=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(e,"__esModule",{value:!0}),e.BlackChariot=e.RedChariot=void 0;var a=n(t(102)),s=t(476),c=function(o){function e(e,t,i){return o.call(this,e,t,s.PieceRole.Chariot,i)||this}return r(e,o),e.prototype.canMove=function(e){var t=e.x_coor,i=e.y_coor;return!(!this.isValidChariotPosition(t,i)||Math.abs(t-this.point.x_coor)>1||Math.abs(i-this.point.y_coor)>1||o.prototype.checkSameColorPieceInPoint.call(this,e))},e}(s.Piece),l=function(o){function e(e,t){var i=o.call(this,t,e,s.PlayerColor.RED)||this;return i.elem.src="../img/pieces/red-ju.png",i.board=e,i.point.setPiece(i),$(i.elem).on("click",(function(){i.movablePoints()})),i}return r(e,o),e.prototype.movablePoints=function(){var o=[];return(o=o.concat(this.checkRow())).concat(this.checkColumn())},e.prototype.checkColumn=function(){a.default.trace("in checkColumns");var o=this.point.y_coor,e=(this.point.x_coor,this.board.getColFromXCoordinate(this.point.x_coor)),t=(this.board.getRowFromYCoordinate(this.point.y_coor),0),i=9;for(var r in e)if(null!=e[r].piece)if(parseInt(r)<o-1)(t=e[r].piece.color==s.PlayerColor.RED?parseInt(r)+1:parseInt(r))===o-1&&(t=o);else if(parseInt(r)>o-1){(i=e[r].piece.color==s.PlayerColor.RED?parseInt(r)-1:parseInt(r))===o-1&&(i=o-2);break}for(var n=[],c=t;c<=i;c++)o-1!==c&&n.push(e[c]);return n},e.prototype.checkRow=function(){a.default.trace("in checkRows()");var o=this.point.x_coor,e=this.board.getRowFromYCoordinate(this.point.y_coor),t=0,i=8;for(var r in e)if(null!=e[r].piece)if(parseInt(r)<o-1)(t=e[r].piece.color==s.PlayerColor.RED?parseInt(r)+1:parseInt(r))===o-1&&(t=o),a.default.trace("start_flag:"+t);else if(parseInt(r)>o-1){(i=e[r].piece.color==s.PlayerColor.RED?parseInt(r)-1:parseInt(r))===o-1&&(i=o-2),a.default.trace("end_flag:"+i);break}for(var n=[],c=t;c<=i;c++)o-1!==c&&n.push(e[c]);return n},e.prototype.isValidChariotPosition=function(o,e){return e>=8&&e<=10&&o>=4&&o<=6},e}(c);e.RedChariot=l;var d=function(o){function e(e,t){var i=o.call(this,t,e,s.PlayerColor.BLACK)||this;return i.elem.src="../img/pieces/black-ju.png",i.board=e,i.point.setPiece(i),$(i.elem).on("click",(function(){i.movablePoints()})),i}return r(e,o),e.prototype.movablePoints=function(){var o=[];return(o=o.concat(this.checkRow())).concat(this.checkColumn())},e.prototype.checkColumn=function(){a.default.trace("in checkColumns"),a.default.trace("Chariots");var o=this.point.y_coor,e=this.board.getColFromXCoordinate(this.point.x_coor),t=0,i=9;for(var r in e)if(a.default.trace("piece_col:"),a.default.trace(e),null!=e[r].piece)if(a.default.trace("有棋子"),parseInt(r)<o-1)e[r].piece.color==s.PlayerColor.BLACK?(a.default.trace("队友在上方"),t=parseInt(r)+1):e[r].piece.color!=s.PlayerColor.BLACK&&(t=parseInt(r),console.log("debugging..........................."),console.log(t)),t===o-1&&(t=o);else if(parseInt(r)>o-1){e[r].piece.color==s.PlayerColor.BLACK?i=parseInt(r)-1:e[r].piece.color!=s.PlayerColor.BLACK&&(i=parseInt(r)),i===o-1&&(i=o-2);break}for(var n=[],c=t;c<=i;c++)o-1!==c&&n.push(e[c]);return console.log(n),n},e.prototype.checkRow=function(){a.default.trace("in checkRows()");var o=this.point.x_coor,e=this.board.getRowFromYCoordinate(this.point.y_coor),t=0,i=8;for(var r in e)if(null!=e[r].piece)if(a.default.trace("有棋子"),a.default.trace(e),parseInt(r)<o-1)e[r].getPiece().isFriendly()?(console.log("---------------------------------debug-----------------------------"),t=parseInt(r)+1):t=parseInt(r),t===o-1&&(t=o),a.default.trace("start_flag:"+t);else if(parseInt(r)>o-1){(i=e[r].getPiece().isFriendly()?parseInt(r)-1:parseInt(r))===o-1&&(i=o-2),a.default.trace("end_flag:"+i);break}for(var n=[],s=t;s<=i;s++)o-1!==s&&n.push(e[s]);return console.log(n),n},e.prototype.isValidChariotPosition=function(o,e){return e>=0&&e<=10&&o>=0&&o<=9},e}(c);e.BlackChariot=d},476:function(o,e,t){var i=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerColor=e.PieceRole=e.Piece=void 0;var r,n=i(t(102)),a=t(950);Object.defineProperty(e,"PlayerColor",{enumerable:!0,get:function(){return a.PlayerColor}}),function(o){o[o.General=0]="General",o[o.Advisor=1]="Advisor",o[o.WarElephant=2]="WarElephant",o[o.Chariot=3]="Chariot",o[o.Horse=4]="Horse",o[o.Cannon=5]="Cannon",o[o.FootSoldier=6]="FootSoldier"}(r||(r={})),e.PieceRole=r;var s=function(){function o(o,e,t,i){this.point=o,this.active=!1,this.board=e,this.piece_role=t,this.color=i,this.elem=document.createElement("img"),this.ratio=100,this.side_length=.01*this.ratio*a.SIDE_LENGTH,this.state=0,$(window).on("mousedown",(function(o){o.preventDefault()})),$(window).on("change",(function(o){o.preventDefault(),console.log("changed")})),this.listenerManager()}return o.prototype.listenerManager=function(){this.attachSelectPieceListener()},o.prototype.attachSelectPieceListener=function(){var o=this;console.log("attachSelectPieceListener, check active:"),console.log(this.board.active_piece),$(this.elem).on("click",(function(e){if(o.board.active_piece)console.log("其他棋子还没走呢！");else{console.log("其他棋子走过了"),console.log("点击了棋子："),console.log(o.elem),e.preventDefault(),$(".className_grid_div").css("background","rgba(3, 181, 252,0.0)");var t=[];t=o.movablePoints(),o.getCurrentPlayer()==o.color&&t.forEach((function(o){$(o.elem).css("background","rgba(3, 181, 252,0.5")})),o.active=!0,o.board.active_piece=o,setTimeout((function(){o.attachMoveToGridListener()}),100)}}))},o.prototype.attachMoveToGridListener=function(){var o=this;console.log(this.point),$(".className_grid_div").on("click",(function(e){if(console.log("点击了棋子:"),console.log(e.target),console.log(e.target.tagName),console.log("棋子所在的格子:"),console.log(e.target.parentNode),console.log(e.target.parentElement),o.board.active_piece&&o.board.game.getCurrentPlayer()==o.color){if(console.log("the piece is selected?"+o.active),console.log("active piece:"),console.log(o.board.active_piece),console.log(o.board.target_coordinate),"IMG"==e.target.tagName.toUpperCase()){console.log("点击了另一个棋子");var t=e.target.parentElement;null!=t&&(console.log("棋子所在的格子："),console.log(t),o.board.target_coordinate=o.board.getCoordinateFromElemId(t.id))}else console.log("点击了一个空的格子"),o.board.target_coordinate=o.board.getCoordinateFromElemId(e.target.id);if(console.log(o.board.getPointFromCoordinates(o.board.target_coordinate[0],o.board.target_coordinate[1])),-1!=o.board.target_coordinate[0]&&-1!=o.board.target_coordinate[1]){if(o.board.getPointFromCoordinates(o.board.target_coordinate[0],o.board.target_coordinate[1]).hasPiece()){if(console.log("该点有棋子"),console.log("=========================== debug ================================="),console.log(o.isFriendly(o.board.getPointFromCoordinates(o.board.target_coordinate[0],o.board.target_coordinate[1]).getPiece())),o.isFriendly(o.board.getPointFromCoordinates(o.board.target_coordinate[0],o.board.target_coordinate[1]).getPiece()))return alert("You Can't Move Here, A Friendly Piece is at this Position"),void o.removeMoveToGridListener();o.isFriendly(o.board.getPointFromCoordinates(o.board.target_coordinate[0],o.board.target_coordinate[1]).getPiece()),delete o.board.getPointFromCoordinates(o.board.target_coordinate[0],o.board.target_coordinate[1]).piece,console.log("=========  debug ==========="),console.log(o.board.getPointFromCoordinates(o.board.target_coordinate[0],o.board.target_coordinate[1])),o.board.getPointFromCoordinates(o.board.target_coordinate[0],o.board.target_coordinate[1]).elem.innerHTML=""}else o.board.getPointFromCoordinates(o.board.target_coordinate[0],o.board.target_coordinate[1]).elem.innerHTML="";console.log(o.board.target_coordinate);var i=o.board.target_coordinate[0],r=o.board.target_coordinate[1];o.board.active_piece.moveToPoint(o.board.getPointFromCoordinates(i,r)),$(".className_grid_div").css("background","rgba(0,0,0,0.0)"),o.board.target_coordinate=[-1,-1],o.active=!1,o.board.game.alternatePlayer()}}else console.log("还没有选择棋子......"),console.log("Is the piece is selected? "+o.active),console.log("Doing nothing..."),$(".className_grid_div").css("background","rgba(0,0,0,0.0)");o.removeMoveToGridListener()}))},o.prototype.removeMoveToGridListener=function(){this.board.active_piece=null,console.log("已经点击了移动目标格,现在移除MoveToGridListener"),$(".className_grid_div").off("click"),$(".className_grid_div").css("background","rgba(0,0,0,0.0)")},o.prototype.movablePoints=function(){return n.default.trace("movable points of a piece"),[]},o.prototype.getElement=function(){return this.elem},o.prototype.moveToPoint=function(o){this.board.intersections[this.point.x_coor-1][this.point.y_coor-1].elem.removeChild(this.elem),delete this.board.intersections[this.point.x_coor-1][this.point.y_coor-1].piece,this.point=o,this.board.intersections[this.point.x_coor-1][this.point.y_coor-1].elem.appendChild(this.elem),this.board.intersections[this.point.x_coor-1][this.point.y_coor-1].piece=this,console.log(this.board.intersections),console.log(this.point),console.log(this.point.x_coor),console.log(this.point.y_coor)},o.prototype.getRole=function(){return this.piece_role},o.prototype.getColor=function(){return this.color},o.prototype.getCurrentPlayer=function(){return this.board.game.getCurrentPlayer()},o.prototype.getTargetPointCoordinate=function(){return this.board.target_coordinate},o.prototype.getTargetPointXCoordinate=function(){return this.board.target_coordinate[0]},o.prototype.getTargetPointYCoordinate=function(){return this.board.target_coordinate[1]},o.prototype.checkSameColorPieceInPoint=function(o){var e=o.getPiece();return!!e&&e.getColor()===this.color},o.prototype.isFriendly=function(o){try{return o||console.log("没有棋子！"),o.getColor()===this.color}catch(o){console.log("没有棋子！")}return!0},o.prototype.isEnemy=function(o){return!!o&&o.getColor()!=this.color},o.prototype.render=function(){this.board.intersections[this.point.x_coor-1][this.point.y_coor-1].elem.append(this.elem),$(this.elem).addClass("pieces"),$(this.elem).addClass(r[this.piece_role].toString()),$(this.elem).addClass(a.PlayerColor[this.color].toString())},o.adjustResize=function(){screen.width==window.innerWidth?(console.log("at exact 100%"),a.getChessBoardSize(),$(".className_grid_div").css("width",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$(".className_grid_div").css("height",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$(".pieces").css("width",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$(".pieces").css("height",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$("#board").css("width",$("#board").css("height")),$("#id_chessboard").css("width",$("#board").css("width"))):screen.width>window.innerWidth?(console.log("you have zoomed in the page i.e more than 100%"),a.getZoomedRatio(),a.getChessBoardSize(),$(".className_grid_div").css("width",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$(".className_grid_div").css("height",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$(".pieces").css("width",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$(".pieces").css("height",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$("#board").css("width",$("#board").css("height")),$("#id_chessboard").css("width",$("#board").css("width"))):(console.log("you have zoomed out i.e less than 100%"),a.getZoomedRatio(),a.getChessBoardSize(),$(".className_grid_div").css("width"),$(".className_grid_div").css("width",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$(".className_grid_div").css("height",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$(".pieces").css("width",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$(".pieces").css("height",a.SIDE_LENGTH*(a.getZoomedRatio()/100)),$("#board").css("width",$("#board").css("height")),$("#id_chessboard").css("width",$("#board").css("width")))},o}();e.Piece=s},251:function(o,e,t){var i,r=this&&this.__extends||(i=function(o,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,e){o.__proto__=e}||function(o,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=e[t])})(o,e)},function(o,e){function t(){this.constructor=o}i(o,e),o.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0}),e.BlackFootSoldier=e.RedFootSoldier=void 0;var n=t(476),a=function(o){function e(e,t,i){return o.call(this,e,t,n.PieceRole.FootSoldier,i)||this}return r(e,o),e.prototype.canMove=function(e){var t=e.x_coor,i=e.y_coor;return!(Math.abs(t-this.point.x_coor)>1||Math.abs(i-this.point.y_coor)>1||o.prototype.checkSameColorPieceInPoint.call(this,e))},e.prototype.isValidFootSoldierPosition=function(o){return o.getY()>=1&&o.getY()<=10&&o.getX()>=1&&o.getX()<=9},e}(n.Piece),s=function(o){function e(e,t){var i=o.call(this,t,e,n.PlayerColor.RED)||this;return i.elem.src="../img/pieces/red-bing.png",i.board=e,i.point.setPiece(i),i}return r(e,o),e.prototype.movablePoints=function(){var o=[];return this.point.getY()<=5?(console.log("过河后"),o=o.concat(this.afterLanding())):this.point.getY()>=6&&(console.log("过河前"),o=o.concat(this.beforeLanding())),o},e.prototype.beforeLanding=function(){var o=this.point.getX(),e=this.point.getY(),t=this.board.getPointFromCoordinates(o,e-1),i=[];return t&&this.isValidFootSoldierPosition(t)&&i.push(t),i},e.prototype.afterLanding=function(){var o=this.point.getX(),e=this.point.getY(),t=this.board.getPointFromCoordinates(o,e-1),i=this.board.getPointFromCoordinates(o-1,e),r=this.board.getPointFromCoordinates(o+1,e),n=[];return t&&this.isValidFootSoldierPosition(t)&&n.push(t),i&&this.isValidFootSoldierPosition(i)&&(console.log("back.getPiece()"),console.log(i.getPiece()),n.push(i)),r&&this.isValidFootSoldierPosition(r)&&(console.log("back.getPiece()"),console.log(r.getPiece()),n.push(r)),n},e}(a);e.RedFootSoldier=s;var c=function(o){function e(e,t){var i=o.call(this,t,e,n.PlayerColor.BLACK)||this;return i.elem.src="../img/pieces/black-zu.png",i.board=e,i.point.setPiece(i),i}return r(e,o),e.prototype.movablePoints=function(){var o=[];return this.point.getY()<=5?(console.log("过河前"),o=o.concat(this.beforeLanding())):this.point.getY()>=6&&(console.log("过河后"),o=o.concat(this.afterLanding())),o},e.prototype.beforeLanding=function(){var o=this.point.getX(),e=this.point.getY(),t=this.board.getPointFromCoordinates(o,e+1),i=[];return t&&this.isValidFootSoldierPosition(t)&&i.push(t),i},e.prototype.afterLanding=function(){var o=this.point.getX(),e=this.point.getY(),t=this.board.getPointFromCoordinates(o,e+1),i=this.board.getPointFromCoordinates(o-1,e),r=this.board.getPointFromCoordinates(o+1,e),n=[];return t&&this.isValidFootSoldierPosition(t)&&n.push(t),i&&this.isValidFootSoldierPosition(i)&&(console.log("back.getPiece()"),console.log(i.getPiece()),n.push(i)),r&&this.isValidFootSoldierPosition(r)&&(console.log("back.getPiece()"),console.log(r.getPiece()),n.push(r)),n},e}(a);e.BlackFootSoldier=c},20:(o,e,t)=>{var i=t(718),r=t(884),n=t(950),a=t(360),s=t(232),c=t(251),l=t(140),d=t(624);(new(function(){function o(){this.currentPlayer=n.PlayerColor.RED,this.board=new i.Board(this)}return o.prototype.getCurrentPlayer=function(){return this.currentPlayer},o.prototype.alternatePlayer=function(){this.currentPlayer===n.PlayerColor.RED?this.currentPlayer=n.PlayerColor.BLACK:this.currentPlayer=n.PlayerColor.RED},o.prototype.render=function(){this.board.render(),new a.RedGeneral(this.board,this.board.getPointFromCoordinates(5,10)).render(),new a.BlackGeneral(this.board,this.board.getPointFromCoordinates(5,1)).render();var o=new r.RedChariot(this.board,this.board.getPointFromCoordinates(1,10)),e=new r.RedChariot(this.board,this.board.getPointFromCoordinates(9,10)),t=new r.BlackChariot(this.board,this.board.getPointFromCoordinates(1,1)),i=new r.BlackChariot(this.board,this.board.getPointFromCoordinates(9,1)),n=new s.RedCannon(this.board,this.board.getPointFromCoordinates(8,3)),h=new s.RedCannon(this.board,this.board.getPointFromCoordinates(8,4)),p=new s.BlackCannon(this.board,this.board.getPointFromCoordinates(2,3)),u=new s.BlackCannon(this.board,this.board.getPointFromCoordinates(2,4)),g=new c.RedFootSoldier(this.board,this.board.getPointFromCoordinates(1,7)),f=new c.BlackFootSoldier(this.board,this.board.getPointFromCoordinates(1,4)),P=new l.RedAdvisor(this.board,this.board.getPointFromCoordinates(4,10)),_=new l.RedAdvisor(this.board,this.board.getPointFromCoordinates(6,10)),b=new l.BlackAdvisor(this.board,this.board.getPointFromCoordinates(4,1)),v=new l.BlackAdvisor(this.board,this.board.getPointFromCoordinates(6,1)),y=new d.BlackWarElephant(this.board,this.board.getPointFromCoordinates(3,1)),m=new d.BlackWarElephant(this.board,this.board.getPointFromCoordinates(7,1)),C=new d.RedWarElephant(this.board,this.board.getPointFromCoordinates(3,10)),w=new d.RedWarElephant(this.board,this.board.getPointFromCoordinates(7,10));o.render(),e.render(),t.render(),i.render(),n.render(),h.render(),p.render(),u.render(),g.render(),f.render(),P.render(),_.render(),b.render(),v.render(),y.render(),m.render(),C.render(),w.render()},o}())).render()},360:function(o,e,t){var i,r=this&&this.__extends||(i=function(o,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,e){o.__proto__=e}||function(o,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=e[t])})(o,e)},function(o,e){function t(){this.constructor=o}i(o,e),o.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0}),e.BlackGeneral=e.RedGeneral=void 0;var n=t(476),a=t(950),s=function(o){function e(e,t,i){return o.call(this,e,t,n.PieceRole.General,i)||this}return r(e,o),e.prototype.canMove=function(e){var t=e.x_coor,i=e.y_coor;return!(Math.abs(t-this.point.x_coor)>1||Math.abs(i-this.point.y_coor)>1||o.prototype.checkSameColorPieceInPoint.call(this,e))},e}(n.Piece),c=function(o){function e(e,t){var i=o.call(this,t,e,n.PlayerColor.RED)||this;return i.elem.src="../img/pieces/red-shuai.png",i.board=e,i.point.setPiece(i),i}return r(e,o),e.prototype.movablePoints=function(){var o=[];return o.concat(this.checkPeriphery())},e.prototype.checkPeriphery=function(){var o=this.point.y_coor,e=this.point.x_coor,t=this.board.getPointFromCoordinates(e,o-1),i=this.board.getPointFromCoordinates(e,o+1),r=this.board.getPointFromCoordinates(e-1,o),n=this.board.getPointFromCoordinates(e+1,o),a=[];return console.log("+++++++++++++ debug +++++++++++++++++++++++"),t&&this.isValidGeneralPosition(t)&&(console.log("front.getPiece()"),console.log(t.getPiece()),a.push(t)),i&&this.isValidGeneralPosition(i)&&(console.log("back.getPiece()"),console.log(i.getPiece()),a.push(i)),r&&this.isValidGeneralPosition(r)&&(console.log("back.getPiece()"),console.log(r.getPiece()),a.push(r)),n&&this.isValidGeneralPosition(n)&&(console.log("back.getPiece()"),console.log(n.getPiece()),a.push(n)),a},e.prototype.isValidGeneralPosition=function(o){return console.log("isValidGeneralPosition +++++++++++"),console.log(o),console.log(o.getX()),console.log(o.getY()),o.getX()-1>=3&&o.getX()-1<=5&&o.getY()-1>=7&&o.getY()-1<=9},e}(s);e.RedGeneral=c;var l=function(o){function e(e,t){var i=o.call(this,t,e,n.PlayerColor.BLACK)||this;return i.elem.src="../img/pieces/black-jiang.png",i.board=e,i.point.setPiece(i),i}return r(e,o),e.prototype.movablePoints=function(){var o=[];return o.concat(this.checkPeriphery())},e.prototype.checkPeriphery=function(){var o=this.point.getX(),e=this.point.getY(),t=this.board.getPointFromCoordinates(o,e-1),i=new a.Point(-1,-1);try{i=this.board.getPointFromCoordinates(o,e+1)}catch(o){console.error(o)}var r=this.board.getPointFromCoordinates(o-1,e),n=this.board.getPointFromCoordinates(o+1,e),s=[];return console.log("++++++++++++++++++++++ debug +++++++++++++++++++++++"),t&&this.isValidGeneralPosition(t)&&(console.log("front.getPiece()"),console.log(t.getPiece()),s.push(t)),i&&this.isValidGeneralPosition(i)&&(console.log("back.getPiece()"),console.log(i.getPiece()),s.push(i)),r&&this.isValidGeneralPosition(r)&&(console.log("back.getPiece()"),console.log(r.getPiece()),s.push(r)),n&&this.isValidGeneralPosition(n)&&(console.log("back.getPiece()"),console.log(n.getPiece()),s.push(n)),s},e.prototype.isValidGeneralPosition=function(o){return console.log("isValidGeneralPosition +++++++++++"),console.log(o),console.log(o.getX()),console.log(o.getY()),o.getX()>=4&&o.getX()-1<=6&&o.getY()>=1&&o.getY()<=3},e}(s);e.BlackGeneral=l},624:function(o,e,t){var i,r=this&&this.__extends||(i=function(o,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,e){o.__proto__=e}||function(o,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=e[t])})(o,e)},function(o,e){function t(){this.constructor=o}i(o,e),o.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),n=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(e,"__esModule",{value:!0}),e.RedWarElephant=e.BlackWarElephant=void 0;var a=n(t(102)),s=t(476),c=t(950),l=function(o){function e(e,t,i){return o.call(this,e,t,s.PieceRole.WarElephant,i)||this}return r(e,o),e.prototype.canMove=function(e){var t=e.x_coor,i=e.y_coor;return!(Math.abs(t-this.point.x_coor)>1||Math.abs(i-this.point.y_coor)>1||o.prototype.checkSameColorPieceInPoint.call(this,e))},e.prototype.movablePoints=function(){var o=[];return o.concat(this.checkMoves())},e.prototype.checkMoves=function(){a.default.trace("in checkMoves()");var o=this.point.getX(),e=this.point.getY(),t=new c.Point(-1,-1),i=new c.Point(-1,-1),r=new c.Point(-1,-1),n=new c.Point(-1,-1),s=new c.Point(-1,-1),l=new c.Point(-1,-1),d=new c.Point(-1,-1),h=new c.Point(-1,-1);i=this.board.getPointFromCoordinates(o+1,e+1),n=this.board.getPointFromCoordinates(o-1,e+1),l=this.board.getPointFromCoordinates(o+1,e-1),h=this.board.getPointFromCoordinates(o-1,e-1);try{i.piece||(t=this.board.getPointFromCoordinates(o+2,e+2))}catch(o){}try{n.piece||(r=this.board.getPointFromCoordinates(o-2,e+2))}catch(o){}try{l.piece||(s=this.board.getPointFromCoordinates(o+2,e-2))}catch(o){}try{h.piece||(d=this.board.getPointFromCoordinates(o-2,e-2))}catch(o){}var p=[];return console.log("++++++++++++++++++++++ debug +++++++++++++++++++++++"),t&&this.isValidPosition(t)&&p.push(t),r&&this.isValidPosition(r)&&p.push(r),s&&this.isValidPosition(s)&&p.push(s),d&&this.isValidPosition(d)&&(console.log(d.getPiece()),p.push(d)),p},e}(s.Piece),d=function(o){function e(e,t){var i=o.call(this,t,e,s.PlayerColor.BLACK)||this;return i.elem.src="../img/pieces/black-xiang.png",i.board=e,i.point.setPiece(i),$(i.elem).on("click",(function(){o.prototype.movablePoints.call(i)})),i}return r(e,o),e.prototype.isValidPosition=function(o){return o.getY()<=5},e}(l);e.BlackWarElephant=d;var h=function(o){function e(e,t){var i=o.call(this,t,e,s.PlayerColor.RED)||this;return i.elem.src="../img/pieces/red-xiang.png",i.board=e,i.point.setPiece(i),$(i.elem).on("click",(function(){o.prototype.movablePoints.call(i)})),i}return r(e,o),e.prototype.isValidPosition=function(o){return o.getY()>=6},e}(l);e.RedWarElephant=h},950:function(o,e,t){var i=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerColor=e.SIDE_LENGTH_vw=e.SIDE_LENGTH=e.Point=e.fitSize=e.getChessBoardSize=e.getZoomedRatio=void 0;var r,n=i(t(102));function a(){var o=0;return void 0!==window.devicePixelRatio?o=window.devicePixelRatio:void 0!==window.outerWidth&&void 0!==window.innerWidth&&(o=window.outerWidth/window.innerWidth),o&&(o=Math.round(100*o)),o}!function(o){o[o.BLACK=0]="BLACK",o[o.RED=1]="RED",o[o.NEUTRAL=2]="NEUTRAL",o[o.SPECTATOR=3]="SPECTATOR"}(r||(r={})),e.PlayerColor=r,e.getZoomedRatio=a,e.getChessBoardSize=function(){n.default.trace("chessboard size:");var o=$("#id_chessboard");n.default.trace("chessboad width"),n.default.trace(o.css("width")),n.default.trace("chessboad height"),n.default.trace(o.css("height"))};var s=function(){function o(o,e){this.x_coor=o,this.y_coor=e,this.elem=document.createElement("div"),this.updateElement(o,e)}return o.prototype.setPiece=function(o){this.piece=o},o.prototype.hasPiece=function(){return!!this.piece},o.prototype.getPiece=function(){return this.piece},o.prototype.getX=function(){return this.x_coor},o.prototype.getY=function(){return this.y_coor},o.prototype.updateElement=function(o,e){var t=this.elem,i=this.x_coor,r=this.y_coor;t.id="grid_div_"+i+"_"+r,$("#"+t.id).remove(),t.className="className_grid_div",$(t).css("grid-column",o),$(t).css("grid-row",e),$("#board").append(t)},o}();e.Point=s,e.SIDE_LENGTH=75;var c=70/(.01*a());e.SIDE_LENGTH_vw=c,e.fitSize=function(){var o=$("#board");$.when(o).then((function(){console.log("background-size"),console.log(o.css("background-size")),o.css("width",o.css("height")),o.css("height",o.css("width")),o.css("column-gap","0px"),console.log(o.css("row-gap"))})).then((function(){$(".className_grid_div").css("width",parseInt(o.css("width"))/11),$(".className_grid_div").css("height",parseInt(o.css("height"))/10),$(".className_grid_div").css("z-index",10),$(".className_grid_div").css("margin",0)})).then((function(){$(".pieces").css("width",parseInt($(".className_grid_div").css("width"))),$(".pieces").css("height",parseInt($(".className_grid_div").css("width")))})).then((function(){o.css("max-width",o.css("height"))}))}},102:function(o,e){var t=this&&this.__spreadArrays||function(){for(var o=0,e=0,t=arguments.length;e<t;e++)o+=arguments[e].length;var i=Array(o),r=0;for(e=0;e<t;e++)for(var n=arguments[e],a=0,s=n.length;a<s;a++,r++)i[r]=n[a];return i};Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function o(){}return o.trace=function(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];console.log.apply(console,t(["<T> "+(new Date).toLocaleString()+":"],o))},o.info=function(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];console.info.apply(console,t(["<I> "+(new Date).toLocaleString()+":"],o))},o.warn=function(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];console.warn.apply(console,t(["<W> "+(new Date).toLocaleString()+":"],o))},o.error=function(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];console.error.apply(console,t(["<E> "+(new Date).toLocaleString()+":"],o))},o.test=function(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];console.log.apply(console,t(["<X> "+(new Date).toLocaleString()+":"],o))},o}();e.default=i}},e={};!function t(i){if(e[i])return e[i].exports;var r=e[i]={exports:{}};return o[i].call(r.exports,r,r.exports,t),r.exports}(20)})();
//# sourceMappingURL=bundle.js.map