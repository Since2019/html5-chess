(()=>{"use strict";var e={718:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Board=void 0;var r=o(950),i=function(){function e(){this.ratio=100,this.side_length=.01*this.ratio*r.SIDE_LENGTH,this.intersections=new Array;for(var e=0;e<9;e++){this.intersections[e]=[];for(var t=0;t<10;t++)this.intersections[e][t]=new r.Point(e+1,t+1)}}return e.prototype.movePieceFromSrcToDest=function(e,t,o){t.setPiece(null),e.moveToPoint(o),o.setPiece(e)},e.prototype.getPointFromCoordinates=function(e,t){return this.validateXCoordinate(e)&&this.validateYCoordinate(t)?this.intersections[e-1][t-1]:null},e.prototype.validateXCoordinate=function(e){return e>=1&&e<=9},e.prototype.validateYCoordinate=function(e){return e>=1&&e<=10},e.prototype.getRowFromYCoordinate=function(e){for(var t=[],o=0;o<9;o++)t.push(this.intersections[o][e-1]);return t},e.prototype.getColFromXCoordinate=function(e){for(var t=[],o=0;o<10;o++)t.push(this.intersections[e-1][o]);return t},e.prototype.detectZoom=function(){var e=0;void 0!==window.devicePixelRatio?e=window.devicePixelRatio:void 0!==window.outerWidth&&void 0!==window.innerWidth&&(e=window.outerWidth/window.innerWidth),e&&(e=Math.round(100*e)),this.ratio=e},e.prototype.render=function(){var e=$("#board");$("#id_chessboard").css("position","fixed"),$("#id_chessboard").css("max-height","100vh"),$("#id_chessboard").css("margin","0"),$("#id_chessboard").css("padding","0vw"),e.css("margin-left","auto"),e.css("margin-right","auto"),e.css("padding",0),$(".className_grid_div").css("background-color","rgba(255,0,0,0.3)"),$(window).on("resize",(function(){r.fitSize()})),$(document).on("ready",(function(){r.fitSize()})),$("#board").css("max-width","100vh")},e}();t.Board=i},884:function(e,t,o){var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(i,n){function s(e){try{a(r.next(e))}catch(e){n(e)}}function c(e){try{a(r.throw(e))}catch(e){n(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,c)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var o,r,i,n,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function c(n){return function(c){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,r=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,c])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BlackChariot=t.RedChariot=void 0;var a=c(o(102)),l=o(476),d=function(e){function t(t,o,r){return e.call(this,t,o,l.PieceRole.General,r)||this}return i(t,e),t.prototype.canMove=function(t){var o=t.x_coor,r=t.y_coor;return!(!this.isValidChariotPosition(o,r)||Math.abs(o-this.point.x_coor)>1||Math.abs(r-this.point.y_coor)>1||e.prototype.checkSameColorPiece.call(this,t))},t}(l.Piece),h=function(e){function t(t,o){var r=e.call(this,o,t,l.PieceColor.RED)||this;return r.elem.src="../img/pieces/red-ju.png",r.board=t,r.point.setPiece(r),$(r.elem).on("click",(function(){r.movablePoints().then((function(e){a.default.trace("movable_grids in the listener"),a.default.trace(e)}))})),r}return i(t,e),t.prototype.movablePoints=function(){return n(this,void 0,void 0,(function(){var e,t=this;return s(this,(function(o){switch(o.label){case 0:return e=[],[4,$.when(e).then((function(){t.checkColumn().then((function(t){a.default.trace("col_movable"),a.default.trace(t),e=e.concat(t)})),t.checkRow().then((function(t){a.default.trace("row_movable"),a.default.trace(t),e=e.concat(t)}))})).then((function(){})).then((function(){return e}))];case 1:return o.sent(),[2,e]}}))}))},t.prototype.checkColumn=function(){return n(this,void 0,void 0,(function(){var e,t,o,r,i,n;return s(this,(function(s){switch(s.label){case 0:for(i in a.default.trace("in checkColumns"),e=this.point.y_coor,this.point.x_coor,t=this.board.getColFromXCoordinate(this.point.x_coor),this.board.getRowFromYCoordinate(this.point.y_coor),o=0,r=9,t)if(null!=t[i].piece)if(parseInt(i)<e-1)(o=t[i].piece.color==l.PieceColor.RED?parseInt(i)+1:parseInt(i))===e-1&&(o=e);else if(parseInt(i)>e-1){(r=t[i].piece.color==l.PieceColor.RED?parseInt(i)-1:parseInt(i))===e-1&&(r=e-2);break}return n=[],[4,$.when(n).then((function(){for(var i=o;i<=r;i++)e-1!==i&&n.push(t[i])})).then((function(){return n}))];case 1:return s.sent(),[2,n]}}))}))},t.prototype.checkRow=function(){return n(this,void 0,void 0,(function(){var e,t,o,r,i,n;return s(this,(function(s){switch(s.label){case 0:for(i in a.default.trace("in checkRows()"),e=this.point.x_coor,t=this.board.getRowFromYCoordinate(this.point.y_coor),o=0,r=8,t)if(null!=t[i].piece)if(parseInt(i)<e-1)(o=t[i].piece.color==l.PieceColor.RED?parseInt(i)+1:parseInt(i))===e-1&&(o=e),a.default.trace("start_flag:"+o);else if(parseInt(i)>e-1){(r=t[i].piece.color==l.PieceColor.RED?parseInt(i)-1:parseInt(i))===e-1&&(r=e-2),a.default.trace("end_flag:"+r);break}return n=[],[4,$.when(n).then((function(){for(var i=o;i<=r;i++)e-1!==i&&n.push(t[i])})).then((function(){return n}))];case 1:return s.sent(),[2,n]}}))}))},t.prototype.isValidChariotPosition=function(e,t){return t>=8&&t<=10&&e>=4&&e<=6&&!(e>0&&t>0)},t}(d);t.RedChariot=h;var u=function(e){function t(t,o){var r=e.call(this,o,t,l.PieceColor.BLACK)||this;return r.elem.src="../img/pieces/black-ju.png",r.board=t,r.point.setPiece(r),$(r.elem).on("click",(function(){console.log("inside click BlackChariot listener"),console.log(r.movablePoints())})),r}return i(t,e),t.prototype.movablePoints=function(){var e=[];return(e=e.concat(this.checkRow())).concat(this.checkColumn())},t.prototype.checkColumn=function(){a.default.trace("in checkColumns");var e=this.point.y_coor,t=(this.point.x_coor,this.board.getColFromXCoordinate(this.point.x_coor)),o=(this.board.getRowFromYCoordinate(this.point.y_coor),0),r=9;for(var i in t)if(null!=t[i].piece)if(parseInt(i)<e-1)(o=t[i].piece.color==l.PieceColor.BLACK?parseInt(i)+1:parseInt(i))===e-1&&(o=e);else if(parseInt(i)>e-1){(r=t[i].piece.color==l.PieceColor.BLACK?parseInt(i)-1:parseInt(i))===e-1&&(r=e-2);break}for(var n=[],s=o;s<=r;s++)e-1!==s&&n.push(t[s]);return console.log(n),n},t.prototype.checkRow=function(){a.default.trace("in checkRows()");var e=this.point.x_coor,t=this.board.getRowFromYCoordinate(this.point.y_coor),o=0,r=8;for(var i in t)if(null!=t[i].piece)if(parseInt(i)<e-1)(o=t[i].piece.isFriendly()?parseInt(i)+1:parseInt(i))===e-1&&(o=e),a.default.trace("start_flag:"+o);else if(parseInt(i)>e-1){(r=t[i].piece.isFriendly()?parseInt(i)-1:parseInt(i))===e-1&&(r=e-2),a.default.trace("end_flag:"+r);break}for(var n=[],s=o;s<=r;s++)e-1!==s&&n.push(t[s]);return console.log(n),n},t.prototype.isValidChariotPosition=function(e,t){return t>=0&&t<=10&&e>=0&&e<=9&&!(e>0&&t>0)},t}(d);t.BlackChariot=u},476:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PieceColor=t.PieceRole=t.Piece=void 0;var r,i,n,s=o(950);!function(e){e[e.BLACK=0]="BLACK",e[e.RED=1]="RED"}(r||(r={})),t.PieceColor=r,function(e){e[e.black=0]="black",e[e.red=1]="red"}(i||(i={})),function(e){e[e.General=0]="General",e[e.Advisor=1]="Advisor",e[e.Elephant=2]="Elephant",e[e.Chariot=3]="Chariot",e[e.Horse=4]="Horse",e[e.Cannon=5]="Cannon",e[e.Soldier=6]="Soldier"}(n||(n={})),t.PieceRole=n;var c=function(){function e(e,t,o,r){this.point=e,this.selected=!1,this.active=!1,this.ratio=100,this.side_length=.01*this.ratio*s.SIDE_LENGTH,this.board=t,this.elem=document.createElement("img"),this.piece_role=o,this.color=r}return e.prototype.getElement=function(){return this.elem},e.prototype.getRole=function(){return this.piece_role},e.prototype.getColor=function(){return this.color},e.prototype.moveToPoint=function(e){this.point=e},e.prototype.checkSameColorPiece=function(e){var t=e.getPiece();return!!t&&t.getColor()===this.color},e.prototype.isFriendly=function(e){return!!e&&e.getColor()===this.color},e.prototype.isEnemy=function(e){return!!e&&e.getColor()!=this.color},e.prototype.render=function(){this.board.intersections[this.point.x_coor-1][this.point.y_coor-1].elem.append(this.elem),$(this.elem).addClass("pieces"),$(this.elem).addClass(n[this.piece_role].toString()),$(this.elem).addClass(r[this.color].toString())},e.adjustResize=function(){screen.width==window.innerWidth?(console.log("at exact 100%"),s.getChessBoardSize(),$(".className_grid_div").css("width",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$(".className_grid_div").css("height",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$(".pieces").css("width",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$(".pieces").css("height",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$("#board").css("width",$("#board").css("height")),$("#id_chessboard").css("width",$("#board").css("width"))):screen.width>window.innerWidth?(console.log("you have zoomed in the page i.e more than 100%"),s.getZoomedRatio(),s.getChessBoardSize(),$(".className_grid_div").css("width",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$(".className_grid_div").css("height",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$(".pieces").css("width",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$(".pieces").css("height",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$("#board").css("width",$("#board").css("height")),$("#id_chessboard").css("width",$("#board").css("width"))):(console.log("you have zoomed out i.e less than 100%"),s.getZoomedRatio(),s.getChessBoardSize(),$(".className_grid_div").css("width"),$(".className_grid_div").css("width",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$(".className_grid_div").css("height",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$(".pieces").css("width",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$(".pieces").css("height",s.SIDE_LENGTH*(s.getZoomedRatio()/100)),$("#board").css("width",$("#board").css("height")),$("#id_chessboard").css("width",$("#board").css("width")))},e}();t.Piece=c},20:(e,t,o)=>{var r=o(718),i=o(884),n=o(950),s=o(360);(new(function(){function e(){this.currentPlayer=n.PlayerColor.red,this.board=new r.Board}return e.prototype.getCurrentPlayer=function(){return this.currentPlayer},e.prototype.alternatePlayer=function(){this.currentPlayer===n.PlayerColor.red?this.currentPlayer=n.PlayerColor.black:this.currentPlayer=n.PlayerColor.red},e.prototype.render=function(){this.board.render(),new s.RedGeneral(this.board,this.board.getPointFromCoordinates(5,10)).render(),new s.BlackGeneral(this.board,this.board.getPointFromCoordinates(5,1)).render();var e=new i.RedChariot(this.board,this.board.getPointFromCoordinates(1,1)),t=new i.RedChariot(this.board,this.board.getPointFromCoordinates(9,1)),o=new i.RedChariot(this.board,this.board.getPointFromCoordinates(9,3)),r=new i.RedChariot(this.board,this.board.getPointFromCoordinates(9,4)),n=new i.BlackChariot(this.board,this.board.getPointFromCoordinates(1,10)),c=new i.BlackChariot(this.board,this.board.getPointFromCoordinates(9,10));e.render(),t.render(),n.render(),c.render(),o.render(),r.render()},e}())).render()},360:function(e,t,o){var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(t,"__esModule",{value:!0}),t.BlackGeneral=t.RedGeneral=void 0;var n=o(476),s=function(e){function t(t,o,r){return e.call(this,t,o,n.PieceRole.General,r)||this}return i(t,e),t.prototype.canMove=function(t){var o=t.x_coor,r=t.y_coor;return!(!this.isValidGeneralPosition(o,r)||Math.abs(o-this.point.x_coor)>1||Math.abs(r-this.point.y_coor)>1||e.prototype.checkSameColorPiece.call(this,t))},t}(n.Piece),c=function(e){function t(t,o){var r=e.call(this,o,t,n.PieceColor.RED)||this;return r.elem.src="../img/pieces/red-shuai.png",r.board=t,r.point.setPiece(r),r}return i(t,e),t.prototype.checkColumns=function(){var e=this.point.y_coor,t=this.point.x_coor,o=this.board.getPointFromCoordinates(t,e-1);this.board.getPointFromCoordinates(t,e+1),o&&(console.log("front.getPiece()"),console.log(o.getPiece())),console.log(this.board.getColFromXCoordinate(t))},t.prototype.checkRows=function(){var e=this.point.y_coor,t=this.point.x_coor,o=this.board.getPointFromCoordinates(t,e-1);this.board.getPointFromCoordinates(t,e+1),o&&(console.log("front.getPiece()"),console.log(o.getPiece())),console.log(this.board.getColFromXCoordinate(t))},t.prototype.isValidGeneralPosition=function(e,t){return t>=8&&t<=10&&e>=4&&e<=6&&!(e>0&&t>0)},t}(s);t.RedGeneral=c;var a=function(e){function t(t,o){var r=e.call(this,o,t,n.PieceColor.BLACK)||this;return r.elem.src="../img/pieces/black-jiang.png",r.board=t,r.point.setPiece(r),r}return i(t,e),t.prototype.isValidGeneralPosition=function(e,t){return t>=1&&t<=3&&e>=4&&e<=6&&!(e>0&&t>0)},t}(s);t.BlackGeneral=a},950:function(e,t,o){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerColor=t.PieceColor=t.SIDE_LENGTH_vw=t.SIDE_LENGTH=t.Point=t.fitSize=t.getChessBoardSize=t.getZoomedRatio=void 0;var i,n,s=r(o(102));function c(){var e=0;return void 0!==window.devicePixelRatio?e=window.devicePixelRatio:void 0!==window.outerWidth&&void 0!==window.innerWidth&&(e=window.outerWidth/window.innerWidth),e&&(e=Math.round(100*e)),e}!function(e){e[e.black=0]="black",e[e.red=1]="red"}(i||(i={})),t.PieceColor=i,function(e){e[e.black=0]="black",e[e.red=1]="red"}(n||(n={})),t.PlayerColor=n,t.getZoomedRatio=c,t.getChessBoardSize=function(){s.default.trace("chessboard size:");var e=$("#id_chessboard");s.default.trace("chessboad width"),s.default.trace(e.css("width")),s.default.trace("chessboad height"),s.default.trace(e.css("height"))};var a=function(){function e(e,t){this.x_coor=e,this.y_coor=t,this.elem=document.createElement("div"),this.updateElement(e,t)}return e.prototype.setPiece=function(e){this.piece=e},e.prototype.hasPiece=function(){return!!this.piece},e.prototype.getPiece=function(){return this.piece},e.prototype.updateElement=function(e,t){var o=this.elem,r=this.x_coor,i=this.y_coor;o.id="grid_div_"+r+"_"+i,$("#"+o.id).remove(),o.className="className_grid_div",$(o).css("grid-column",e),$(o).css("grid-row",t),$("#board").append(o)},e}();t.Point=a,t.SIDE_LENGTH=75;var l=70/(.01*c());t.SIDE_LENGTH_vw=l,t.fitSize=function(){var e=$("#board");$.when().then((function(){e.css("width",e.css("height")),e.css("height",e.css("width"))})).then((function(){$(".className_grid_div").css("width",parseInt(e.css("width"))/11),$(".className_grid_div").css("height",parseInt(e.css("height"))/10),$(".className_grid_div").css("z-index",10),$(".className_grid_div").css("margin",0)})).then((function(){$(".pieces").css("width",parseInt($(".className_grid_div").css("width"))),$(".pieces").css("height",parseInt($(".className_grid_div").css("width")))})).then((function(){e.css("max-width",e.css("height"))}))}},102:function(e,t){var o=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<o;t++)for(var n=arguments[t],s=0,c=n.length;s<c;s++,i++)r[i]=n[s];return r};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.trace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(console,o(["<T> "+(new Date).toLocaleString()+":"],e))},e.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.info.apply(console,o(["<I> "+(new Date).toLocaleString()+":"],e))},e.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn.apply(console,o(["<W> "+(new Date).toLocaleString()+":"],e))},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.error.apply(console,o(["<E> "+(new Date).toLocaleString()+":"],e))},e.test=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(console,o(["<X> "+(new Date).toLocaleString()+":"],e))},e}();t.default=r}},t={};!function o(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,o),i.exports}(20)})();
//# sourceMappingURL=bundle.js.map